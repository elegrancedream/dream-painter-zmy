var K=Object.defineProperty;var G=(e,t,i)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var P=(e,t,i)=>G(e,typeof t!="symbol"?t+"":t,i);import{r as m,a as Y,R as z}from"./react-vendor-wGySg1uH.js";import{m as h,A}from"./framer-motion--IpldGsu.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}})();var V={exports:{}},C={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H=m,J=Symbol.for("react.element"),W=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,Z=H.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q={key:!0,ref:!0,__self:!0,__source:!0};function F(e,t,i){var r,a={},s=null,o=null;i!==void 0&&(s=""+i),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)X.call(t,r)&&!Q.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:J,type:e,key:s,ref:o,props:a,_owner:Z.current}}C.Fragment=W;C.jsx=F;C.jsxs=F;V.exports=C;var n=V.exports,S={},M=Y;S.createRoot=M.createRoot,S.hydrateRoot=M.hydrateRoot;function ee(){const e=["å…è´¹åˆ†æ","AI ç»˜å›¾","æ— éœ€ç™»å½•"];return n.jsxs(h.div,{className:"text-center mb-8 md:mb-12",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[n.jsx(h.h1,{className:"text-5xl md:text-6xl font-bold text-indigo-900 mb-5 md:mb-6 drop-shadow-lg",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.1},children:"Dream Painter"}),n.jsxs(h.div,{className:"mb-7 md:mb-8",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},children:[n.jsx("p",{className:"text-xl md:text-2xl text-indigo-800 font-medium mb-1",children:"æ•æ‰æ½œæ„è¯†çš„å¾®å…‰ï¼Œç»˜åˆ¶ç‹¬å±äºä½ çš„æ¢¦å¢ƒ"}),n.jsx("p",{className:"text-base md:text-xl text-indigo-700/80 italic",children:"Capture the glimmer of the subconscious, paint your unique dream"})]}),n.jsx(h.div,{className:"flex flex-wrap justify-center gap-3 md:gap-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.3},children:e.map((t,i)=>n.jsx(h.span,{className:"px-4 py-2 rounded-full bg-white/30 text-indigo-900 text-base md:text-xl font-medium backdrop-blur-md border-2 border-white/50 shadow-md",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.4+i*.1},children:t},t))})]})}function te({children:e}){return n.jsxs("div",{className:"aurora-bg min-h-screen w-full relative overflow-hidden",children:[n.jsx("div",{className:"texture-overlay noise-texture"}),n.jsx("div",{className:"relative z-10 max-w-full md:max-w-[1176px] mx-auto px-4 pt-8 md:pt-12",children:n.jsx(ee,{})}),n.jsx("div",{className:"relative z-10 max-w-full md:max-w-[1176px] mx-auto px-4 py-8 md:py-12",children:e})]})}function ne({userInput:e,error:t,onInputChange:i}){return n.jsxs("div",{className:"w-full",children:[n.jsx("h3",{className:"text-[22.5px] md:text-[25px] font-bold text-indigo-900 -mt-[11.25px] md:-mt-[12.5px] mb-4",children:"æ¢¦å¢ƒè¾“å…¥"}),n.jsx("textarea",{value:e,onChange:r=>i(r.target.value),placeholder:"åœ¨è¿™é‡Œæè¿°ä½ çš„æ¢¦å¢ƒ...",className:`
          w-full px-5 py-4 rounded-xl border-2
          bg-white/50 backdrop-blur-sm
          border-white/50 focus:border-indigo-400
          focus:outline-none focus:ring-2 focus:ring-indigo-300/50
          text-slate-800 placeholder:text-gray-400
          text-base md:text-xl
          resize-none min-h-[150px] md:min-h-[180px]
          transition-all duration-200
          ${t?"border-red-300 focus:border-red-400 focus:ring-red-300/50":""}
        `,"aria-label":"æ¢¦å¢ƒæè¿°è¾“å…¥æ¡†","aria-describedby":t?"error-message":"helper-text"}),t&&n.jsx("p",{id:"error-message",className:"mt-2 text-sm text-red-600 font-medium",role:"alert",children:t}),n.jsx("p",{id:"helper-text",className:"mt-2 text-base md:text-xl text-gray-500",children:"ä¸ºäº†è·å¾—æœ€ä½³æ•ˆæœï¼Œè¯·æè¿°ä½ çš„æ¢¦å¢ƒå¹¶é€‰æ‹©è‰ºæœ¯é£æ ¼"})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),D=(e,t)=>{const i=m.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:l="",children:d,...y},b)=>m.createElement("svg",{ref:b,...ie,width:a,height:a,stroke:r,strokeWidth:o?Number(s)*24/Number(a):s,className:["lucide",`lucide-${re(e)}`,l].join(" "),...y},[...t.map(([w,k])=>m.createElement(w,k)),...Array.isArray(d)?d:[d]]));return i.displayName=`${e}`,i};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=D("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=D("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),le=[{id:"Ghibli",name:"æ²»æ„ˆç«¥è¯é£",icon:"ğŸŒ¿",color:"#90EE90"},{id:"Van Gogh",name:"æ²¹ç”»ç¬”è§¦é£",icon:"â­",color:"#FFD700"},{id:"Cthulhu",name:"ç¥ç§˜ä½è¯­é£",icon:"ğŸ™",color:"#4B0082"},{id:"Minimalist",name:"æŠ½è±¡æç®€é£",icon:"â—¯",color:"#000000"},{id:"Cyber_Xianxia",name:"ç§‘å¹»ä»™ä¾ é£",icon:"âš¡",color:"#00FFFF"}];function ce({value:e,onChange:t,styles:i=le}){const[r,a]=m.useState(!1),[s,o]=m.useState(-1),l=m.useRef(null),d=m.useRef(null);m.useEffect(()=>{const c=f=>{l.current&&!l.current.contains(f.target)&&(a(!1),o(-1))};return r&&document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[r]);const y=c=>{if(!r){(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),a(!0),o(-1));return}switch(c.key){case"Escape":c.preventDefault(),a(!1),o(-1),l.current&&l.current.querySelector("button").focus();break;case"Enter":c.preventDefault(),s>=0&&s<i.length?w(i[s].id):s===-1&&e&&a(!1);break;case"ArrowDown":c.preventDefault(),o(f=>f<i.length-1?f+1:0);break;case"ArrowUp":c.preventDefault(),o(f=>f>0?f-1:i.length-1);break;case"Home":c.preventDefault(),o(0);break;case"End":c.preventDefault(),o(i.length-1);break}},b=i.find(c=>c.id===e),w=c=>{t(c),a(!1),o(-1),l.current&&l.current.querySelector("button").focus()},k=()=>{a(!r),o(-1)};return n.jsxs("div",{className:"relative",ref:l,children:[n.jsxs("button",{onClick:k,onKeyDown:y,className:"px-4 py-2 rounded-lg border border-white/50 bg-white/30 backdrop-blur-sm hover:bg-white/40 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 transition-colors duration-200 flex items-center justify-between gap-2 min-w-[160px]","aria-label":"é€‰æ‹©è‰ºæœ¯é£æ ¼","aria-expanded":r,"aria-haspopup":"listbox",role:"combobox",children:[n.jsx("span",{className:"text-lg md:text-xl text-indigo-900 font-medium text-left",children:b?`è‰ºæœ¯é£æ ¼: ${b.name}`:"è‰ºæœ¯é£æ ¼"}),n.jsx(se,{className:`w-4 h-4 text-indigo-700 transition-transform duration-200 flex-shrink-0 ${r?"transform rotate-180":""}`})]}),n.jsx(A,{children:r&&n.jsx(h.div,{ref:d,className:"absolute top-full left-0 mt-2 w-full bg-white/90 backdrop-blur-md rounded-lg shadow-xl border border-white/50 z-50 overflow-hidden",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},role:"listbox","aria-label":"è‰ºæœ¯é£æ ¼é€‰é¡¹",children:i.length===0?n.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"æš‚æ— å¯ç”¨é£æ ¼"}):i.map((c,f)=>n.jsxs("button",{onClick:()=>w(c.id),onKeyDown:y,className:`
                    w-full px-4 py-3 text-left hover:bg-indigo-50 transition-colors duration-150
                    flex items-center justify-start gap-3 focus:outline-none focus:bg-indigo-50
                    ${e===c.id?"bg-indigo-100":""}
                    ${s===f?"bg-indigo-50":""}
                  `,role:"option","aria-selected":e===c.id,tabIndex:s===f?0:-1,children:[n.jsx("span",{className:"text-xl flex-shrink-0 w-6 text-center",children:c.icon}),n.jsx("span",{className:"text-sm md:text-base text-indigo-900 font-medium text-left",children:c.name})]},c.id))})})]})}function de({onClick:e}){return n.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 text-lg md:text-xl","aria-label":"æ¸…é™¤è¾“å…¥å†…å®¹",children:"æ¸…é™¤"})}function ue({onClick:e,loading:t=!1,disabled:i=!1,children:r}){const a=i||t;return n.jsx("button",{onClick:e,disabled:a,className:`
        px-6 py-3 rounded-lg font-semibold text-white
        bg-gradient-to-r from-purple-500 to-pink-500
        hover:from-purple-600 hover:to-pink-600
        active:from-purple-700 active:to-pink-700
        transition-all duration-200
        flex items-center justify-center gap-2
        shadow-lg hover:shadow-xl
        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"}
      `,"aria-label":t?"ç”Ÿæˆä¸­...":"ç»˜åˆ¶æ¢¦å¢ƒ",children:t?n.jsxs(n.Fragment,{children:[n.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 12 5.373 12 12H4z"})]}),n.jsx("span",{children:"ç”Ÿæˆä¸­..."})]}):n.jsxs(n.Fragment,{children:[n.jsx(oe,{className:"w-4 h-4"}),n.jsx("span",{className:"text-lg md:text-xl",children:r||"Paint Dream"})]})})}function me({selectedStyle:e,onStyleChange:t,onClear:i,onSubmit:r,isSubmitting:a,userInput:s}){const o=!s||!e||a;return n.jsx("div",{className:"border-t border-white/20 mt-5 pt-5",children:n.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-stretch md:items-center gap-4",children:[n.jsx("div",{className:"flex-1 md:flex-none",children:n.jsx(ce,{value:e,onChange:t})}),n.jsxs("div",{className:"flex flex-row gap-3 justify-end",children:[n.jsx(de,{onClick:i}),n.jsx(ue,{onClick:r,loading:a,disabled:o})]})]})})}function q(e){if(!e||typeof e!="string")return{valid:!1,error:"è¯·è¾“å…¥æ¢¦å¢ƒæè¿°"};const t=e.trim();return t.length===0?{valid:!1,error:"è¯·è¾“å…¥æ¢¦å¢ƒæè¿°"}:t.length<3?{valid:!1,error:"æ¢¦å¢ƒæè¿°è‡³å°‘éœ€è¦3ä¸ªå­—ç¬¦"}:t.length>1e3?{valid:!1,error:"æ¢¦å¢ƒæè¿°ä¸èƒ½è¶…è¿‡1000ä¸ªå­—ç¬¦"}:{valid:!0}}function U(e){const t=["Ghibli","Van Gogh","Cthulhu","Minimalist","Cyber_Xianxia"];return!e||typeof e!="string"?{valid:!1,error:"è¯·é€‰æ‹©è‰ºæœ¯é£æ ¼"}:t.includes(e)?{valid:!0}:{valid:!1,error:"æ— æ•ˆçš„è‰ºæœ¯é£æ ¼"}}function pe(e){return!e||typeof e!="object"?{valid:!1,error:"APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šä¸æ˜¯å¯¹è±¡"}:!("advice"in e)||typeof e.advice!="string"?{valid:!1,error:"APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šç¼ºå°‘adviceå­—æ®µ"}:!("keywords"in e)||!Array.isArray(e.keywords)?{valid:!1,error:"APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼škeywordså­—æ®µå¿…é¡»æ˜¯æ•°ç»„"}:"image_url"in e&&e.image_url!==null&&typeof e.image_url!="string"?{valid:!1,error:"APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šimage_urlå­—æ®µç±»å‹é”™è¯¯"}:"diagnosis"in e&&e.diagnosis!==null&&typeof e.diagnosis!="string"?{valid:!1,error:"APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šdiagnosiså­—æ®µç±»å‹é”™è¯¯"}:{valid:!0,data:{image_url:e.image_url??null,diagnosis:e.diagnosis??null,advice:e.advice,keywords:Array.isArray(e.keywords)?e.keywords:[]}}}const $=m.memo(function({userInput:t,selectedStyle:i,onInputChange:r,onStyleChange:a,onSubmit:s,onClear:o}){const[l,d]=m.useState(null),[y,b]=m.useState(!1),w=m.useCallback(g=>{r(g),l&&d(null)},[r,l]),k=m.useCallback(g=>{a(g),l&&d(null)},[a,l]),c=m.useCallback(()=>{o(),d(null),b(!1)},[o]),f=m.useCallback(async()=>{const g=q(t);if(!g.valid){d(g.error);return}const E=U(i);if(!E.valid){d(E.error);return}d(null),b(!0);try{await s(t.trim(),i)}catch(x){d(x.message||"æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{b(!1)}},[t,i,s]);return n.jsxs("div",{className:"bg-white/40 backdrop-blur-md border border-white/50 rounded-2xl shadow-xl max-w-full md:max-w-[1176px] mx-auto p-8 md:p-10",children:[n.jsx(ne,{userInput:t,error:l,onInputChange:w}),n.jsx(me,{selectedStyle:i,onStyleChange:k,onClear:c,onSubmit:f,isSubmitting:y,userInput:t})]})});function fe({message:e}){const t=["æ­£åœ¨æ”¶é›†ç‹¬è§’å…½çš„çœ¼æ³ª...","æ­£åœ¨ç¼è¡¥äº‘æœµ...","æ­£åœ¨è°ƒè‰²æ¢¦å¢ƒ...","æ­£åœ¨å”¤é†’æ²‰ç¡çš„ç”»ç¬”...","æ­£åœ¨ç¼–ç»‡æ¢¦å¢ƒç¢ç‰‡...","æ­£åœ¨æ•æ‰æ˜Ÿå…‰...","æ­£åœ¨ç»˜åˆ¶ä½ çš„æ¢¦å¢ƒ..."],i=e||t[Math.floor(Math.random()*t.length)];return n.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[400px]",children:[n.jsx(h.div,{className:"cloudmorphism p-8 mb-6",animate:{y:[0,-10,0],scale:[1,1.05,1]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:n.jsx("div",{className:"text-6xl mb-4",children:"â˜ï¸"})}),n.jsx(h.p,{className:"text-2xl md:text-3xl font-baloo text-white text-glow text-center",animate:{opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:i})]})}function xe({advice:e,onClose:t}){return n.jsx(A,{children:n.jsxs(h.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,children:[n.jsx(h.div,{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}),n.jsx(h.div,{className:"cloudmorphism p-6 md:p-8 max-w-md relative z-10 cursor-pointer",initial:{x:-300,opacity:0,scale:.8},animate:{x:0,opacity:1,scale:1},exit:{x:300,opacity:0,scale:.8},transition:{type:"spring",stiffness:300,damping:30},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:i=>i.stopPropagation(),children:n.jsxs(h.div,{animate:{y:[0,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:[n.jsx("p",{className:"text-lg md:text-xl font-nunito text-white text-glow text-center mb-4",children:e}),n.jsx("p",{className:"text-sm text-white/70 text-center",children:"ç‚¹å‡»ä»»æ„ä½ç½®ç»§ç»­"})]})})]})})}function B(e,t=100){let i=0,r=null;return function(...a){const s=Date.now(),o=s-i;o>=t?(i=s,e.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i=Date.now(),e.apply(this,a)},t-o))}}function he(){const[e,t]=m.useState({beta:0,gamma:0,isSupported:!1});return m.useEffect(()=>{if(typeof DeviceOrientationEvent>"u")return;typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(r=>{r==="granted"&&(t(a=>({...a,isSupported:!0})),i())}).catch(()=>{}):(t(r=>({...r,isSupported:!0})),i());function i(){const r=s=>{t({beta:s.beta||0,gamma:s.gamma||0,isSupported:!0})};window.addEventListener("deviceorientation",r);const a=()=>{document.hidden?window.removeEventListener("deviceorientation",r):window.addEventListener("deviceorientation",r)};return document.addEventListener("visibilitychange",a),()=>{window.removeEventListener("deviceorientation",r),document.removeEventListener("visibilitychange",a)}}return i()},[]),e}function ge(){const[e,t]=m.useState({rotateX:0,rotateY:0}),{beta:i,gamma:r,isSupported:a}=he(),s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);return m.useEffect(()=>{if(s&&a)return;const o=B(l=>{const{clientX:d,clientY:y}=l,{innerWidth:b,innerHeight:w}=window,k=(d/b-.5)*2,c=(y/w-.5)*-2;t({rotateX:c,rotateY:k})},100);return window.addEventListener("mousemove",o),()=>{window.removeEventListener("mousemove",o)}},[s,a]),m.useEffect(()=>{if(!s||!a)return;const o=Math.max(-1,Math.min(1,i/45)),l=Math.max(-1,Math.min(1,r/45));B(()=>{t({rotateX:o,rotateY:l})},200)()},[i,r,s,a]),e}function ye({imageUrl:e,diagnosis:t,advice:i,keywords:r,onBack:a}){const{rotateX:s,rotateY:o}=ge();return n.jsxs("div",{className:"w-full max-w-[1029px] mx-auto relative",children:[n.jsxs(h.button,{onClick:a,className:"fixed top-4 md:top-8 left-4 md:left-8 flex items-center gap-2 text-xl md:text-2xl text-indigo-800 font-medium transition-all duration-200 hover:text-indigo-900 hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 rounded-lg px-2 py-1 z-50",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.9},transition:{delay:.3},"aria-label":"è¿”å›æ¢¦å¢ƒè¾“å…¥ç•Œé¢",tabIndex:0,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),a())},children:[n.jsx(ae,{className:"w-5 h-5 md:w-6 md:h-6"}),n.jsx("span",{children:"è¿”å›"})]}),n.jsx(h.div,{className:"relative",initial:{rotateY:-90,opacity:0},animate:{rotateY:0,opacity:1},transition:{duration:1,ease:"easeOut"},children:n.jsxs("div",{className:"cloudmorphism p-[28px] md:p-[35px]",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-[28px]",children:[n.jsxs(h.div,{className:"p-[28px] bg-white/20 rounded-lg backdrop-blur-sm",style:{perspective:"1000px"},children:[n.jsx("h3",{className:"text-[27.5625px] md:text-[36.75px] font-baloo text-indigo-900 mb-4",style:{textShadow:"0 2px 8px rgba(99, 102, 241, 0.2), 0 0 20px rgba(139, 92, 246, 0.15)",filter:"drop-shadow(0 2px 4px rgba(99, 102, 241, 0.1))"},children:"æ¢¦å¢ƒè¯Šæ–­ä¹¦"}),n.jsx("div",{className:"text-indigo-900 font-nunito leading-relaxed whitespace-pre-wrap text-[18.28px] md:text-[20.32px]",children:t}),i&&n.jsx("div",{className:"mt-4 pt-4 border-t border-white/20",children:n.jsxs("p",{className:"text-indigo-600/90 text-[18.28px] md:text-[20.32px]",children:["âœ¨ ",i]})})]}),n.jsx(h.div,{className:"relative",style:{perspective:"1000px",transform:`perspective(1000px) rotateX(${s*10}deg) rotateY(${o*10}deg)`,transformStyle:"preserve-3d"},children:n.jsx(h.img,{src:e,alt:"ç”Ÿæˆçš„æ¢¦å¢ƒç”»ä½œ",className:"w-full h-auto rounded-lg shadow-2xl",loading:"lazy",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},onError:l=>{l.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="400"%3E%3Crect fill="%23ccc" width="400" height="400"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="18" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3Eå›¾ç‰‡åŠ è½½å¤±è´¥%3C/text%3E%3C/svg%3E'}})})]}),r&&r.length>0&&n.jsx(h.div,{className:"mt-[28px] flex flex-wrap gap-[10.5px] justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},children:r.map((l,d)=>n.jsxs(h.span,{className:"px-4 py-2 bg-indigo-500/20 backdrop-blur-md rounded-full text-indigo-800 text-[18.29px] md:text-[20.57px] font-nunito border border-indigo-400/30 shadow-md hover:bg-indigo-500/30 transition-colors",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.9+d*.1},children:["#",l]},d))})]})})]})}class R extends Error{constructor(t,i){super(i),this.name="ApiError",this.statusCode=t}}function be(e){let t="å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•",i="UNKNOWN_ERROR";if(e.message&&e.message.includes("APIé…ç½®é”™è¯¯"))return i="CONFIG_ERROR",t=e.message,console.error("é…ç½®é”™è¯¯:",{message:e.message,hint:"è¯·æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼šVITE_COZE_BOT_ID å’Œ VITE_COZE_TOKEN",env:{mode:"production",botId:"å·²é…ç½®",token:"å·²é…ç½®"}}),{message:t,type:i,originalError:e};if(e instanceof R)switch(i="API_ERROR",e.statusCode){case 400:t="è¾“å…¥å†…å®¹æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥";break;case 401:case 403:e.message&&(e.message.includes("4101")||e.message.includes("token ä¸åˆæ³•")||e.message.includes("Bearer token"))?t="Token è®¤è¯å¤±è´¥ï¼šè¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®ã€æ˜¯å¦å·²è¿‡æœŸï¼Œæˆ–æ˜¯å¦éœ€è¦åœ¨ Coze å¹³å°é‡æ–°ç”Ÿæˆ Token":t="è®¤è¯å¤±è´¥ï¼šè¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®æˆ–å·²è¿‡æœŸ";break;case 404:t="API åœ°å€ä¸å­˜åœ¨ï¼šè¯·æ£€æŸ¥ API URL æ˜¯å¦æ­£ç¡®";break;case 429:t="è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•";break;case 500:t="æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•";break;case 502:case 503:t="æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•";break;case 504:t="ç”Ÿæˆæ—¶é—´è¾ƒé•¿ï¼Œè¯·ç¨å€™...";break;default:t=e.message||`APIé”™è¯¯ (${e.statusCode})`}else e.message&&e.message.includes("è¶…æ—¶")||e.name==="TimeoutError"?(i="TIMEOUT_ERROR",t=e.message||"ç”Ÿæˆæ—¶é—´è¾ƒé•¿ï¼Œè¯·ç¨å€™..."):e.message&&e.message.includes("æ ¼å¼")||e.name==="ValidationError"?(i="VALIDATION_ERROR",t=e.message||"æ•°æ®æ ¼å¼å¼‚å¸¸ï¼Œè¯·é‡è¯•"):e.message&&e.message.includes("ç½‘ç»œ")&&(i="NETWORK_ERROR",t="ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•");return{message:t,type:i,originalError:e}}async function we(e,t){const i=q(e);if(!i.valid)throw new Error(i.error);const r=U(t);if(!r.valid)throw new Error(r.error);const a="https://api.coze.cn/open_api/v2/chat",s="7589462495971475456";let o="pat_OdzZPJyUzBtoIeQpegamJxKZiwAtpIM7iv1MGTH10iIGQmvK5pwFCPuM1Ke2jQ9D";if(!o)throw new Error("APIé…ç½®é”™è¯¯ï¼šè¯·æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€è¦ VITE_COZE_BOT_ID å’Œ VITE_COZE_TOKENï¼‰");o=o.trim().replace(/\n/g,"").replace(/\r/g,"");let l="Bearer";(o.startsWith("pat_")||o.startsWith("cztei_"))&&(l="Bearer");const d=`${e.trim()}
é£æ ¼: ${t}`,y={bot_id:s,user:"dream_painter_user",query:d,stream:!1},b={method:"POST",headers:{"Content-Type":"application/json",Authorization:`${l} ${o}`},body:JSON.stringify(y)},w=new AbortController,c=setTimeout(()=>{w.abort()},18e4);try{const f=Date.now(),g=await fetch(a,{...b,signal:w.signal}),E=Date.now()-f;if(clearTimeout(c),!g.ok){let j={};try{const p=await g.text();j=p?JSON.parse(p):{}}catch{}let u=j.msg||j.message||j.error||`APIè¯·æ±‚å¤±è´¥: ${g.status} ${g.statusText}`;throw(j.code===4101||u.includes("Bearer token")||u.includes("token ä¸åˆæ³•"))&&(u=`Token è®¤è¯å¤±è´¥ï¼ˆ4101ï¼‰ï¼šè¯·æ£€æŸ¥ä»¥ä¸‹äº‹é¡¹ï¼š
1. Token æ˜¯å¦æ­£ç¡®ï¼ˆç¡®ä¿æ²¡æœ‰å¤šä½™ç©ºæ ¼ï¼‰
2. Token æ˜¯å¦å·²è¿‡æœŸ
3. æ˜¯å¦éœ€è¦åœ¨ Coze å¹³å°é‡æ–°ç”Ÿæˆ Token
4. å‚è€ƒæ–‡æ¡£ï¼šhttps://coze.cn/docs/developer_guides/authentication`),new R(g.status,u)}const x=await g.json();let v=null;if(x.messages&&Array.isArray(x.messages)&&x.messages.length>0){let j=x.messages.find(u=>u.type==="answer"&&u.content);if(j||(j=x.messages.find(u=>u.content&&u.type!=="function_call"&&u.type!=="tool_response"&&u.type!=="verbose")),j&&j.content){const u=j.content;try{const p=JSON.parse(u);p&&typeof p=="object"&&(p.image_url||p.diagnosis||p.advice)&&(v=p)}catch{}}if(!v){for(const u of x.messages)if(u.content&&typeof u.content=="string")try{const p=JSON.parse(u.content);if(p&&typeof p=="object"&&(p.image_url!==void 0||p.diagnosis!==void 0||p.advice!==void 0||p.keywords!==void 0)){v=p;break}}catch{continue}}if(!v){for(const u of x.messages)if(u.content&&typeof u.content=="string"){const p=u.content.match(/https?:\/\/[^\s"']+\.(jpg|jpeg|png|gif|webp)/i);if(p){const O=p[0];let T=null,I=u.content,L=[];try{const N=JSON.parse(u.content);N&&typeof N=="object"?v={image_url:N.image_url||O,diagnosis:N.diagnosis||null,advice:N.advice||I,keywords:N.keywords||[]}:v={image_url:O,diagnosis:T,advice:I,keywords:L}}catch{v={image_url:O,diagnosis:T,advice:I,keywords:L}}break}}}if(!v){const u=x.messages[x.messages.length-1];v={advice:(u==null?void 0:u.content)||"ç”Ÿæˆå®Œæˆï¼Œä½†æœªæ‰¾åˆ°å›¾ç‰‡æ•°æ®",image_url:null,diagnosis:null,keywords:[]}}}else v=x;const _=pe(v);if(!_.valid){const j=new Error(_.error);throw j.name="ValidationError",j}return _.data}catch(f){if(clearTimeout(c),f.name==="AbortError"){const g=new Error("è¯·æ±‚è¶…æ—¶ï¼šç”Ÿæˆå›¾ç‰‡éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·ç¨åé‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥");throw g.name="TimeoutError",g}throw f instanceof R||f.name==="ValidationError"?f:new Error(`ç½‘ç»œé”™è¯¯: ${f.message}`)}}function ve(){const[e,t]=m.useState("landing"),[i,r]=m.useState(""),[a,s]=m.useState(null),[o,l]=m.useState(null),[d,y]=m.useState(null);m.useEffect(()=>{},[]);const b=async(g,E)=>{r(g),s(E),t("loading"),y(null);try{const x=await we(g,E);l(x),x.image_url===null&&x.diagnosis===null?t("guide"):x.image_url!==null&&x.diagnosis!==null?t("result"):(y({message:"APIè¿”å›æ•°æ®æ ¼å¼å¼‚å¸¸",type:"VALIDATION_ERROR"}),t("landing"))}catch(x){const v=be(x);y({message:v.message,type:v.type}),t("landing")}},w=()=>{r(""),s(null),y(null),l(null)},k=()=>{t("landing"),r(""),s(null),l(null)},c=()=>{r(""),s(null),y(null),l(null),t("landing")},f=()=>{switch(e){case"landing":return n.jsx($,{userInput:i,selectedStyle:a,onInputChange:r,onStyleChange:s,onSubmit:b,onClear:w});case"loading":return n.jsx(fe,{});case"guide":return o&&n.jsx(xe,{advice:o.advice,onClose:k});case"result":return o&&o.image_url&&o.diagnosis&&n.jsx(ye,{imageUrl:o.image_url,diagnosis:o.diagnosis,advice:o.advice,keywords:o.keywords,onBack:c});default:return n.jsx($,{userInput:i,selectedStyle:a,onInputChange:r,onStyleChange:s,onSubmit:b,onClear:w})}};return n.jsxs(te,{children:[n.jsx(A,{mode:"wait",children:f()}),d&&n.jsxs(h.div,{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 cloudmorphism p-4 max-w-md z-50",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:[n.jsx("p",{className:"text-white text-center",children:(d==null?void 0:d.message)||(typeof d=="string"?d:"å‘ç”ŸæœªçŸ¥é”™è¯¯")}),!1,n.jsx("button",{onClick:()=>{y(null),t("landing")},className:"mt-2 w-full py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition",children:"è¿”å›"})]})]})}class je extends z.Component{constructor(i){super(i);P(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,r){console.error("é”™è¯¯è¾¹ç•Œæ•è·:",i,r),this.setState({error:i,errorInfo:r})}render(){return this.state.hasError?n.jsx("div",{className:"aurora-bg min-h-screen w-full flex flex-col items-center justify-center p-4",style:{background:"linear-gradient(to bottom right, #fbcfe8, #c4b5fd, #818cf8)"},children:n.jsxs("div",{className:"bg-white/40 backdrop-blur-md border border-white/50 rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[n.jsx("div",{className:"text-6xl mb-4",children:"ğŸ˜”"}),n.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-indigo-900 mb-4",children:"é¡µé¢åŠ è½½å‡ºé”™"}),n.jsx("p",{className:"text-indigo-800 mb-6",children:"æŠ±æ­‰ï¼Œé¡µé¢é‡åˆ°äº†é—®é¢˜ã€‚è¯·å°è¯•åˆ·æ–°é¡µé¢ï¼Œæˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚"}),n.jsx("button",{onClick:this.handleReload,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors duration-200 mb-4 w-full",children:"åˆ·æ–°é¡µé¢"}),!1]})}):this.props.children}}S.createRoot(document.getElementById("root")).render(n.jsx(z.StrictMode,{children:n.jsx(je,{children:n.jsx(ve,{})})}));
//# sourceMappingURL=index-vD0nJhXI.js.map
