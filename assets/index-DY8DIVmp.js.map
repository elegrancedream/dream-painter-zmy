{"version":3,"file":"index-DY8DIVmp.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../src/components/HeroHeader.jsx","../../src/components/Layout.jsx","../../src/components/DreamInput.jsx","../../node_modules/lucide-react/dist/esm/defaultAttributes.js","../../node_modules/lucide-react/dist/esm/createLucideIcon.js","../../node_modules/lucide-react/dist/esm/icons/arrow-left.js","../../node_modules/lucide-react/dist/esm/icons/chevron-down.js","../../node_modules/lucide-react/dist/esm/icons/sparkles.js","../../src/config/styles.js","../../src/components/StyleDropdown.jsx","../../src/components/ClearButton.jsx","../../src/components/MainCTAButton.jsx","../../src/components/ControlBar.jsx","../../src/utils/dataValidator.js","../../src/components/LandingCard.jsx","../../src/components/Loading.jsx","../../src/components/GuideBubble.jsx","../../src/utils/throttle.js","../../src/hooks/useDeviceOrientation.js","../../src/hooks/useParallax.js","../../src/components/DreamBook.jsx","../../src/utils/errorHandler.js","../../src/api/coze.js","../../src/App.jsx","../../src/components/ErrorBoundary.jsx","../../src/main.jsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import React from 'react'\r\nimport { motion } from 'framer-motion'\r\n\r\n/**\r\n * HeroHeaderç»„ä»¶\r\n *\r\n * åŠŸèƒ½ï¼šå±•ç¤ºå“ç‰ŒLogoã€å‰¯æ ‡é¢˜å’ŒåŠŸèƒ½å¾½ç« \r\n *\r\n * @component\r\n * @example\r\n * <HeroHeader />\r\n */\r\nexport default function HeroHeader() {\r\n  const badges = ['å…è´¹åˆ†æ', 'AI ç»˜å›¾', 'æ— éœ€ç™»å½•']\r\n\r\n  return (\r\n    <motion.div\r\n      className=\"text-center mb-8 md:mb-12\"\r\n      initial={{ opacity: 0, y: -20 }}\r\n      animate={{ opacity: 1, y: 0 }}\r\n      transition={{ duration: 0.5 }}\r\n    >\r\n      {/* Logo */}\r\n      <motion.h1\r\n        className=\"text-5xl md:text-6xl font-bold text-indigo-900 mb-5 md:mb-6 drop-shadow-lg\"\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        transition={{ duration: 0.5, delay: 0.1 }}\r\n      >\r\n        Dream Painter\r\n      </motion.h1>\r\n\r\n      {/* Subtitle */}\r\n      <motion.div\r\n        className=\"mb-7 md:mb-8\"\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        transition={{ duration: 0.5, delay: 0.2 }}\r\n      >\r\n        <p className=\"text-xl md:text-2xl text-indigo-800 font-medium mb-1\">\r\n          æ•æ‰æ½œæ„è¯†çš„å¾®å…‰ï¼Œç»˜åˆ¶ç‹¬å±äºä½ çš„æ¢¦å¢ƒ\r\n        </p>\r\n        <p className=\"text-base md:text-xl text-indigo-700/80 italic\">\r\n          Capture the glimmer of the subconscious, paint your unique dream\r\n        </p>\r\n      </motion.div>\r\n\r\n      {/* Badges */}\r\n      <motion.div\r\n        className=\"flex flex-wrap justify-center gap-3 md:gap-4\"\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        transition={{ duration: 0.5, delay: 0.3 }}\r\n      >\r\n        {badges.map((badge, index) => (\r\n          <motion.span\r\n            key={badge}\r\n            className=\"px-4 py-2 rounded-full bg-white/30 text-indigo-900 text-base md:text-xl font-medium backdrop-blur-md border-2 border-white/50 shadow-md\"\r\n            initial={{ opacity: 0, scale: 0.8 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            transition={{ duration: 0.3, delay: 0.4 + index * 0.1 }}\r\n          >\r\n            {badge}\r\n          </motion.span>\r\n        ))}\r\n      </motion.div>\r\n    </motion.div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React from 'react'\nimport HeroHeader from './HeroHeader'\nimport '../styles/index.css'\nimport '../styles/textures.css'\n\n/**\n * å¸ƒå±€ç»„ä»¶\n * æä¾›å…¨å±€èƒŒæ™¯ã€çº¹ç†å åŠ å’Œå“åº”å¼å®¹å™¨\n * å¢å¼ºï¼šæ·»åŠ HeroHeaderåŒºåŸŸï¼Œè°ƒæ•´ä¸»å®¹å™¨å®½åº¦\n *\n * @param {Object} props\n * @param {React.ReactNode} props.children - å­ç»„ä»¶\n */\nexport default function Layout({ children }) {\n  return (\n    <div className=\"aurora-bg min-h-screen w-full relative overflow-hidden\">\n      {/* çº¹ç†å åŠ å±‚ */}\n      <div className=\"texture-overlay noise-texture\" />\n\n      {/* Hero Header */}\n      <div className=\"relative z-10 max-w-full md:max-w-[1176px] mx-auto px-4 pt-8 md:pt-12\">\n        <HeroHeader />\n      </div>\n\n      {/* ä¸»å†…å®¹å®¹å™¨ */}\n      <div className=\"relative z-10 max-w-full md:max-w-[1176px] mx-auto px-4 py-8 md:py-12\">\n        {children}\n      </div>\n    </div>\n  )\n}\n\n","import React from 'react'\r\n\r\n/**\r\n * DreamInputç»„ä»¶\r\n *\r\n * åŠŸèƒ½ï¼šæ¢¦å¢ƒè¾“å…¥ç»„ä»¶ï¼ŒåŒ…å«è¾“å…¥åŒºåŸŸæ ‡é¢˜ã€å¤§å‹æ–‡æœ¬è¾“å…¥æ¡†ã€é”™è¯¯æç¤ºå’Œå¸®åŠ©æ–‡æœ¬\r\n *\r\n * @param {Object} props\r\n * @param {string} props.userInput - ç”¨æˆ·è¾“å…¥çš„æ¢¦å¢ƒæè¿°\r\n * @param {string|null} props.error - é”™è¯¯ä¿¡æ¯ï¼Œnullè¡¨ç¤ºæ— é”™è¯¯\r\n * @param {Function} props.onInputChange - è¾“å…¥å˜åŒ–å›è°ƒå‡½æ•°\r\n */\r\nexport default function DreamInput({ userInput, error, onInputChange }) {\r\n  return (\r\n    <div className=\"w-full\">\r\n      {/* Section Title */}\r\n      <h3 className=\"text-[22.5px] md:text-[25px] font-bold text-indigo-900 -mt-[11.25px] md:-mt-[12.5px] mb-4\">\r\n        æ¢¦å¢ƒè¾“å…¥\r\n      </h3>\r\n\r\n      {/* Text Area */}\r\n      <textarea\r\n        value={userInput}\r\n        onChange={(e) => onInputChange(e.target.value)}\r\n        placeholder=\"åœ¨è¿™é‡Œæè¿°ä½ çš„æ¢¦å¢ƒ...\"\r\n        className={`\r\n          w-full px-5 py-4 rounded-xl border-2\r\n          bg-white/50 backdrop-blur-sm\r\n          border-white/50 focus:border-indigo-400\r\n          focus:outline-none focus:ring-2 focus:ring-indigo-300/50\r\n          text-slate-800 placeholder:text-gray-400\r\n          text-base md:text-xl\r\n          resize-none min-h-[150px] md:min-h-[180px]\r\n          transition-all duration-200\r\n          ${error ? 'border-red-300 focus:border-red-400 focus:ring-red-300/50' : ''}\r\n        `}\r\n        aria-label=\"æ¢¦å¢ƒæè¿°è¾“å…¥æ¡†\"\r\n        aria-describedby={error ? 'error-message' : 'helper-text'}\r\n      />\r\n\r\n      {/* Error Message */}\r\n      {error && (\r\n        <p\r\n          id=\"error-message\"\r\n          className=\"mt-2 text-sm text-red-600 font-medium\"\r\n          role=\"alert\"\r\n        >\r\n          {error}\r\n        </p>\r\n      )}\r\n\r\n      {/* Helper Text */}\r\n      <p\r\n        id=\"helper-text\"\r\n        className=\"mt-2 text-base md:text-xl text-gray-500\"\r\n      >\r\n        ä¸ºäº†è·å¾—æœ€ä½³æ•ˆæœï¼Œè¯·æè¿°ä½ çš„æ¢¦å¢ƒå¹¶é€‰æ‹©è‰ºæœ¯é£æ ¼\r\n      </p>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nvar defaultAttributes = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: 24,\n  height: 24,\n  viewBox: \"0 0 24 24\",\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 2,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\"\n};\n\nexport { defaultAttributes as default };\n//# sourceMappingURL=defaultAttributes.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport { forwardRef, createElement } from 'react';\nimport defaultAttributes from './defaultAttributes.js';\n\nconst toKebabCase = (string) => string.replace(/([a-z0-9])([A-Z])/g, \"$1-$2\").toLowerCase().trim();\nconst createLucideIcon = (iconName, iconNode) => {\n  const Component = forwardRef(\n    ({ color = \"currentColor\", size = 24, strokeWidth = 2, absoluteStrokeWidth, className = \"\", children, ...rest }, ref) => createElement(\n      \"svg\",\n      {\n        ref,\n        ...defaultAttributes,\n        width: size,\n        height: size,\n        stroke: color,\n        strokeWidth: absoluteStrokeWidth ? Number(strokeWidth) * 24 / Number(size) : strokeWidth,\n        className: [\"lucide\", `lucide-${toKebabCase(iconName)}`, className].join(\" \"),\n        ...rest\n      },\n      [\n        ...iconNode.map(([tag, attrs]) => createElement(tag, attrs)),\n        ...Array.isArray(children) ? children : [children]\n      ]\n    )\n  );\n  Component.displayName = `${iconName}`;\n  return Component;\n};\n\nexport { createLucideIcon as default, toKebabCase };\n//# sourceMappingURL=createLucideIcon.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ArrowLeft = createLucideIcon(\"ArrowLeft\", [\n  [\"path\", { d: \"m12 19-7-7 7-7\", key: \"1l729n\" }],\n  [\"path\", { d: \"M19 12H5\", key: \"x3x0zl\" }]\n]);\n\nexport { ArrowLeft as default };\n//# sourceMappingURL=arrow-left.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst ChevronDown = createLucideIcon(\"ChevronDown\", [\n  [\"path\", { d: \"m6 9 6 6 6-6\", key: \"qrunsl\" }]\n]);\n\nexport { ChevronDown as default };\n//# sourceMappingURL=chevron-down.js.map\n","/**\n * @license lucide-react v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Sparkles = createLucideIcon(\"Sparkles\", [\n  [\n    \"path\",\n    {\n      d: \"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z\",\n      key: \"17u4zn\"\n    }\n  ],\n  [\"path\", { d: \"M5 3v4\", key: \"bklmnn\" }],\n  [\"path\", { d: \"M19 17v4\", key: \"iiml17\" }],\n  [\"path\", { d: \"M3 5h4\", key: \"nem4j1\" }],\n  [\"path\", { d: \"M17 19h4\", key: \"lbex7p\" }]\n]);\n\nexport { Sparkles as default };\n//# sourceMappingURL=sparkles.js.map\n","/**\r\n * é£æ ¼é…ç½®æ•°æ®\r\n *\r\n * ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è‰ºæœ¯é£æ ¼çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬IDã€åç§°ã€å›¾æ ‡å’Œé¢œè‰²\r\n * ä¾¿äºå…¶ä»–ç»„ä»¶å¤ç”¨å’Œç»´æŠ¤\r\n */\r\n\r\n/**\r\n * é£æ ¼é…ç½®ç±»å‹å®šä¹‰\r\n * @typedef {Object} StyleConfig\r\n * @property {string} id - é£æ ¼å”¯ä¸€æ ‡è¯†ç¬¦\r\n * @property {string} name - é£æ ¼æ˜¾ç¤ºåç§°\r\n * @property {string} icon - é£æ ¼å›¾æ ‡ï¼ˆemojiæˆ–å­—ç¬¦ï¼‰\r\n * @property {string} color - é£æ ¼ä¸»é¢˜é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰\r\n */\r\n\r\n/**\r\n * æ‰€æœ‰å¯ç”¨çš„è‰ºæœ¯é£æ ¼é…ç½®\r\n * @type {StyleConfig[]}\r\n */\r\nexport const STYLES = [\r\n  {\r\n    id: 'Ghibli',\r\n    name: 'æ²»æ„ˆç«¥è¯é£',\r\n    icon: 'ğŸŒ¿',\r\n    color: '#90EE90'\r\n  },\r\n  {\r\n    id: 'Van Gogh',\r\n    name: 'æ²¹ç”»ç¬”è§¦é£',\r\n    icon: 'â­',\r\n    color: '#FFD700'\r\n  },\r\n  {\r\n    id: 'Cthulhu',\r\n    name: 'ç¥ç§˜ä½è¯­é£',\r\n    icon: 'ğŸ™',\r\n    color: '#4B0082'\r\n  },\r\n  {\r\n    id: 'Minimalist',\r\n    name: 'æŠ½è±¡æç®€é£',\r\n    icon: 'â—¯',\r\n    color: '#000000'\r\n  },\r\n  {\r\n    id: 'Cyber_Xianxia',\r\n    name: 'ç§‘å¹»ä»™ä¾ é£',\r\n    icon: 'âš¡',\r\n    color: '#00FFFF'\r\n  }\r\n]\r\n\r\n/**\r\n * è·å–é£æ ¼é…ç½®\r\n * @param {string} styleId - é£æ ¼ID\r\n * @returns {StyleConfig|undefined} é£æ ¼é…ç½®å¯¹è±¡ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›undefined\r\n */\r\nexport function getStyleById(styleId) {\r\n  return STYLES.find(style => style.id === styleId)\r\n}\r\n\r\n/**\r\n * éªŒè¯é£æ ¼IDæ˜¯å¦æœ‰æ•ˆ\r\n * @param {string} styleId - é£æ ¼ID\r\n * @returns {boolean} æ˜¯å¦ä¸ºæœ‰æ•ˆçš„é£æ ¼ID\r\n */\r\nexport function isValidStyleId(styleId) {\r\n  return STYLES.some(style => style.id === styleId)\r\n}\r\n\r\n\r\n\r\n","import React, { useState, useRef, useEffect } from 'react'\nimport { motion, AnimatePresence } from 'framer-motion'\nimport { ChevronDown } from 'lucide-react'\nimport { STYLES as DEFAULT_STYLES } from '../config/styles'\n\n/**\n * StyleDropdownç»„ä»¶\n *\n * åŠŸèƒ½ï¼šé£æ ¼ä¸‹æ‹‰èœå•ç»„ä»¶ï¼Œæ›¿ä»£åŸæœ‰çš„StyleBubblesç»„ä»¶\n * æ”¯æŒé”®ç›˜å¯¼èˆªï¼šEnteré€‰æ‹©ã€Escapeå…³é—­ã€æ–¹å‘é”®å¯¼èˆª\n *\n * @param {Object} props\n * @param {string|null} props.value - å½“å‰é€‰ä¸­çš„é£æ ¼ID\n * @param {Function} props.onChange - é£æ ¼å˜åŒ–å›è°ƒå‡½æ•°\n * @param {Array} [props.styles] - é£æ ¼é…ç½®æ•°ç»„ï¼Œå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å†…ç½®é…ç½®\n */\nexport default function StyleDropdown({ value, onChange, styles = DEFAULT_STYLES }) {\n  const [isOpen, setIsOpen] = useState(false)\n  const [focusedIndex, setFocusedIndex] = useState(-1)\n  const dropdownRef = useRef(null)\n  const menuRef = useRef(null)\n\n  // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰èœå•\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n        setIsOpen(false)\n        setFocusedIndex(-1)\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside)\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [isOpen])\n\n  // é”®ç›˜å¯¼èˆªå¤„ç†\n  const handleKeyDown = (e) => {\n    if (!isOpen) {\n      // ä¸‹æ‹‰èœå•å…³é—­æ—¶ï¼ŒæŒ‰Enteræˆ–Spaceæ‰“å¼€\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault()\n        setIsOpen(true)\n        setFocusedIndex(-1)\n      }\n      return\n    }\n\n    // ä¸‹æ‹‰èœå•æ‰“å¼€æ—¶çš„é”®ç›˜æ“ä½œ\n    switch (e.key) {\n      case 'Escape':\n        e.preventDefault()\n        setIsOpen(false)\n        setFocusedIndex(-1)\n        // å°†ç„¦ç‚¹è¿”å›åˆ°è§¦å‘æŒ‰é’®\n        if (dropdownRef.current) {\n          dropdownRef.current.querySelector('button').focus()\n        }\n        break\n\n      case 'Enter':\n        e.preventDefault()\n        if (focusedIndex >= 0 && focusedIndex < styles.length) {\n          handleSelect(styles[focusedIndex].id)\n        } else if (focusedIndex === -1 && value) {\n          // å¦‚æœå½“å‰æœ‰é€‰ä¸­é¡¹ï¼Œå†æ¬¡æŒ‰Enteré€‰æ‹©å½“å‰é¡¹ï¼ˆå®é™…æ˜¯å…³é—­ï¼‰\n          setIsOpen(false)\n        }\n        break\n\n      case 'ArrowDown':\n        e.preventDefault()\n        setFocusedIndex(prev => {\n          if (prev < styles.length - 1) {\n            return prev + 1\n          }\n          return 0 // å¾ªç¯åˆ°ç¬¬ä¸€ä¸ª\n        })\n        break\n\n      case 'ArrowUp':\n        e.preventDefault()\n        setFocusedIndex(prev => {\n          if (prev > 0) {\n            return prev - 1\n          }\n          return styles.length - 1 // å¾ªç¯åˆ°æœ€åä¸€ä¸ª\n        })\n        break\n\n      case 'Home':\n        e.preventDefault()\n        setFocusedIndex(0)\n        break\n\n      case 'End':\n        e.preventDefault()\n        setFocusedIndex(styles.length - 1)\n        break\n\n      default:\n        break\n    }\n  }\n\n  // è·å–å½“å‰é€‰ä¸­çš„é£æ ¼\n  const selectedStyle = styles.find(style => style.id === value)\n\n  // å¤„ç†é£æ ¼é€‰æ‹©\n  const handleSelect = (styleId) => {\n    onChange(styleId)\n    setIsOpen(false)\n    setFocusedIndex(-1)\n    // å°†ç„¦ç‚¹è¿”å›åˆ°è§¦å‘æŒ‰é’®\n    if (dropdownRef.current) {\n      dropdownRef.current.querySelector('button').focus()\n    }\n  }\n\n  // æ‰“å¼€ä¸‹æ‹‰èœå•æ—¶é‡ç½®ç„¦ç‚¹\n  const handleToggle = () => {\n    setIsOpen(!isOpen)\n    setFocusedIndex(-1)\n  }\n\n  return (\n    <div className=\"relative\" ref={dropdownRef}>\n      {/* Dropdown Trigger */}\n      <button\n        onClick={handleToggle}\n        onKeyDown={handleKeyDown}\n        className=\"px-4 py-2 rounded-lg border border-white/50 bg-white/30 backdrop-blur-sm hover:bg-white/40 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 transition-colors duration-200 flex items-center justify-between gap-2 min-w-[160px]\"\n        aria-label=\"é€‰æ‹©è‰ºæœ¯é£æ ¼\"\n        aria-expanded={isOpen}\n        aria-haspopup=\"listbox\"\n        role=\"combobox\"\n      >\n        <span className=\"text-lg md:text-xl text-indigo-900 font-medium text-left\">\n          {selectedStyle ? `è‰ºæœ¯é£æ ¼: ${selectedStyle.name}` : 'è‰ºæœ¯é£æ ¼'}\n        </span>\n        <ChevronDown\n          className={`w-4 h-4 text-indigo-700 transition-transform duration-200 flex-shrink-0 ${\n            isOpen ? 'transform rotate-180' : ''\n          }`}\n        />\n      </button>\n\n      {/* Dropdown Menu */}\n      <AnimatePresence>\n        {isOpen && (\n          <motion.div\n            ref={menuRef}\n            className=\"absolute top-full left-0 mt-2 w-full bg-white/90 backdrop-blur-md rounded-lg shadow-xl border border-white/50 z-50 overflow-hidden\"\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            transition={{ duration: 0.2 }}\n            role=\"listbox\"\n            aria-label=\"è‰ºæœ¯é£æ ¼é€‰é¡¹\"\n          >\n            {styles.length === 0 ? (\n              <div className=\"px-4 py-3 text-sm text-gray-500 text-center\">\n                æš‚æ— å¯ç”¨é£æ ¼\n              </div>\n            ) : (\n              styles.map((style, index) => (\n                <button\n                  key={style.id}\n                  onClick={() => handleSelect(style.id)}\n                  onKeyDown={handleKeyDown}\n                  className={`\n                    w-full px-4 py-3 text-left hover:bg-indigo-50 transition-colors duration-150\n                    flex items-center justify-start gap-3 focus:outline-none focus:bg-indigo-50\n                    ${value === style.id ? 'bg-indigo-100' : ''}\n                    ${focusedIndex === index ? 'bg-indigo-50' : ''}\n                  `}\n                  role=\"option\"\n                  aria-selected={value === style.id}\n                  tabIndex={focusedIndex === index ? 0 : -1}\n                >\n                  <span className=\"text-xl flex-shrink-0 w-6 text-center\">{style.icon}</span>\n                  <span className=\"text-sm md:text-base text-indigo-900 font-medium text-left\">\n                    {style.name}\n                  </span>\n                </button>\n              ))\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  )\n}\n\n","import React from 'react'\r\n\r\n/**\r\n * ClearButtonç»„ä»¶\r\n *\r\n * åŠŸèƒ½ï¼šæ¸…é™¤æŒ‰é’®ï¼Œç”¨äºæ¸…ç©ºè¾“å…¥å†…å®¹\r\n *\r\n * @param {Object} props\r\n * @param {Function} props.onClick - ç‚¹å‡»å›è°ƒå‡½æ•°\r\n */\r\nexport default function ClearButton({ onClick }) {\r\n  return (\r\n    <button\r\n      onClick={onClick}\r\n      className=\"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 text-lg md:text-xl\"\r\n      aria-label=\"æ¸…é™¤è¾“å…¥å†…å®¹\"\r\n    >\r\n      æ¸…é™¤\r\n    </button>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React from 'react'\r\nimport { Sparkles } from 'lucide-react'\r\n\r\n/**\r\n * MainCTAButtonç»„ä»¶\r\n *\r\n * åŠŸèƒ½ï¼šä¸»CTAæŒ‰é’®ï¼Œç”¨äºæäº¤ç”Ÿæˆè¯·æ±‚\r\n *\r\n * @param {Object} props\r\n * @param {Function} props.onClick - ç‚¹å‡»å›è°ƒå‡½æ•°\r\n * @param {boolean} [props.loading=false] - æ˜¯å¦å¤„äºåŠ è½½çŠ¶æ€\r\n * @param {boolean} [props.disabled=false] - æ˜¯å¦ç¦ç”¨\r\n * @param {React.ReactNode} [props.children] - è‡ªå®šä¹‰å†…å®¹ï¼Œé»˜è®¤ä¸º\"Paint Dream\"\r\n */\r\nexport default function MainCTAButton({ onClick, loading = false, disabled = false, children }) {\r\n  const isDisabled = disabled || loading\r\n\r\n  return (\r\n    <button\r\n      onClick={onClick}\r\n      disabled={isDisabled}\r\n      className={`\r\n        px-6 py-3 rounded-lg font-semibold text-white\r\n        bg-gradient-to-r from-purple-500 to-pink-500\r\n        hover:from-purple-600 hover:to-pink-600\r\n        active:from-purple-700 active:to-pink-700\r\n        transition-all duration-200\r\n        flex items-center justify-center gap-2\r\n        shadow-lg hover:shadow-xl\r\n        ${isDisabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\r\n      `}\r\n      aria-label={loading ? 'ç”Ÿæˆä¸­...' : 'ç»˜åˆ¶æ¢¦å¢ƒ'}\r\n    >\r\n      {loading ? (\r\n        <>\r\n          <svg\r\n            className=\"animate-spin h-5 w-5 text-white\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            fill=\"none\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <circle\r\n              className=\"opacity-25\"\r\n              cx=\"12\"\r\n              cy=\"12\"\r\n              r=\"10\"\r\n              stroke=\"currentColor\"\r\n              strokeWidth=\"4\"\r\n            />\r\n            <path\r\n              className=\"opacity-75\"\r\n              fill=\"currentColor\"\r\n              d=\"M4 12a8 8 0 018-8V0C5.373 0 12 5.373 12 12H4z\"\r\n            />\r\n          </svg>\r\n          <span>ç”Ÿæˆä¸­...</span>\r\n        </>\r\n      ) : (\r\n        <>\r\n          <Sparkles className=\"w-4 h-4\" />\r\n          <span className=\"text-lg md:text-xl\">{children || 'Paint Dream'}</span>\r\n        </>\r\n      )}\r\n    </button>\r\n  )\r\n}\r\n\r\n\r\n\r\n","import React from 'react'\r\nimport StyleDropdown from './StyleDropdown'\r\nimport ClearButton from './ClearButton'\r\nimport MainCTAButton from './MainCTAButton'\r\n\r\n/**\r\n * ControlBarç»„ä»¶\r\n *\r\n * åŠŸèƒ½ï¼šæ§åˆ¶æ ç»„ä»¶ï¼Œæ•´åˆé£æ ¼é€‰æ‹©å’Œæ“ä½œæŒ‰é’®\r\n *\r\n * @param {Object} props\r\n * @param {string|null} props.selectedStyle - å½“å‰é€‰ä¸­çš„é£æ ¼ID\r\n * @param {Function} props.onStyleChange - é£æ ¼å˜åŒ–å›è°ƒå‡½æ•°\r\n * @param {Function} props.onClear - æ¸…é™¤å›è°ƒå‡½æ•°\r\n * @param {Function} props.onSubmit - æäº¤å›è°ƒå‡½æ•°\r\n * @param {boolean} props.isSubmitting - æ˜¯å¦æ­£åœ¨æäº¤\r\n * @param {string} props.userInput - ç”¨æˆ·è¾“å…¥å†…å®¹ï¼Œç”¨äºåˆ¤æ–­disabledçŠ¶æ€\r\n */\r\nexport default function ControlBar({\r\n  selectedStyle,\r\n  onStyleChange,\r\n  onClear,\r\n  onSubmit,\r\n  isSubmitting,\r\n  userInput\r\n}) {\r\n  const isDisabled = !userInput || !selectedStyle || isSubmitting\r\n\r\n  return (\r\n    <div className=\"border-t border-white/20 mt-5 pt-5\">\r\n      <div className=\"flex flex-col md:flex-row justify-between items-stretch md:items-center gap-4\">\r\n        {/* Left Side: Style Dropdown */}\r\n        <div className=\"flex-1 md:flex-none\">\r\n          <StyleDropdown\r\n            value={selectedStyle}\r\n            onChange={onStyleChange}\r\n          />\r\n        </div>\r\n\r\n        {/* Right Side: Action Buttons */}\r\n        <div className=\"flex flex-row gap-3 justify-end\">\r\n          <ClearButton onClick={onClear} />\r\n          <MainCTAButton\r\n            onClick={onSubmit}\r\n            loading={isSubmitting}\r\n            disabled={isDisabled}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n","/**\n * æ•°æ®éªŒè¯å·¥å…·å‡½æ•°\n */\n\n/**\n * éªŒè¯ç”¨æˆ·è¾“å…¥çš„æ¢¦å¢ƒæè¿°\n * @param {string} input - ç”¨æˆ·è¾“å…¥\n * @returns {Object} { valid: boolean, error?: string }\n */\nexport function validateUserInput(input) {\n  if (!input || typeof input !== 'string') {\n    return { valid: false, error: 'è¯·è¾“å…¥æ¢¦å¢ƒæè¿°' }\n  }\n\n  const trimmed = input.trim()\n\n  if (trimmed.length === 0) {\n    return { valid: false, error: 'è¯·è¾“å…¥æ¢¦å¢ƒæè¿°' }\n  }\n\n  if (trimmed.length < 3) {\n    return { valid: false, error: 'æ¢¦å¢ƒæè¿°è‡³å°‘éœ€è¦3ä¸ªå­—ç¬¦' }\n  }\n\n  if (trimmed.length > 1000) {\n    return { valid: false, error: 'æ¢¦å¢ƒæè¿°ä¸èƒ½è¶…è¿‡1000ä¸ªå­—ç¬¦' }\n  }\n\n  return { valid: true }\n}\n\n/**\n * éªŒè¯é£æ ¼é€‰æ‹©\n * @param {string} style - é£æ ¼æ ‡è¯†\n * @returns {Object} { valid: boolean, error?: string }\n */\nexport function validateStyle(style) {\n  const validStyles = ['Ghibli', 'Van Gogh', 'Cthulhu', 'Minimalist', 'Cyber_Xianxia']\n\n  if (!style || typeof style !== 'string') {\n    return { valid: false, error: 'è¯·é€‰æ‹©è‰ºæœ¯é£æ ¼' }\n  }\n\n  if (!validStyles.includes(style)) {\n    return { valid: false, error: 'æ— æ•ˆçš„è‰ºæœ¯é£æ ¼' }\n  }\n\n  return { valid: true }\n}\n\n/**\n * éªŒè¯APIå“åº”æ•°æ®\n * @param {any} data - APIå“åº”æ•°æ®\n * @returns {Object} { valid: boolean, error?: string, data?: GenerationResponse }\n */\nexport function validateApiResponse(data) {\n  // åŸºç¡€ç±»å‹æ£€æŸ¥\n  if (!data || typeof data !== 'object') {\n    return { valid: false, error: 'APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šä¸æ˜¯å¯¹è±¡' }\n  }\n\n  // æ£€æŸ¥å¿…éœ€å­—æ®µ\n  if (!('advice' in data) || typeof data.advice !== 'string') {\n    return { valid: false, error: 'APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šç¼ºå°‘adviceå­—æ®µ' }\n  }\n\n  if (!('keywords' in data) || !Array.isArray(data.keywords)) {\n    return { valid: false, error: 'APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼škeywordså­—æ®µå¿…é¡»æ˜¯æ•°ç»„' }\n  }\n\n  // æ£€æŸ¥å¯é€‰å­—æ®µç±»å‹\n  if ('image_url' in data && data.image_url !== null && typeof data.image_url !== 'string') {\n    return { valid: false, error: 'APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šimage_urlå­—æ®µç±»å‹é”™è¯¯' }\n  }\n\n  if ('diagnosis' in data && data.diagnosis !== null && typeof data.diagnosis !== 'string') {\n    return { valid: false, error: 'APIå“åº”æ•°æ®æ ¼å¼é”™è¯¯ï¼šdiagnosiså­—æ®µç±»å‹é”™è¯¯' }\n  }\n\n  // æ„å»ºæ ‡å‡†å“åº”å¯¹è±¡\n  const response = {\n    image_url: data.image_url ?? null,\n    diagnosis: data.diagnosis ?? null,\n    advice: data.advice,\n    keywords: Array.isArray(data.keywords) ? data.keywords : [],\n  }\n\n  return { valid: true, data: response }\n}\n\n","import React, { useState, useEffect, memo, useCallback } from 'react'\nimport DreamInput from './DreamInput'\nimport ControlBar from './ControlBar'\nimport { validateUserInput, validateStyle } from '../utils/dataValidator'\n\n/**\n * LandingCardç»„ä»¶\n *\n * åŠŸèƒ½ï¼šä¸»å¡ç‰‡å®¹å™¨ç»„ä»¶ï¼Œå®ç°Glassmorphismæ•ˆæœï¼Œæ•´åˆDreamInputå’ŒControlBar\n * ä½¿ç”¨React.memoä¼˜åŒ–ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“\n *\n * @param {Object} props\n * @param {string} props.userInput - ç”¨æˆ·è¾“å…¥çš„æ¢¦å¢ƒæè¿°ï¼ˆå¤–éƒ¨çŠ¶æ€ï¼‰\n * @param {string|null} props.selectedStyle - é€‰ä¸­çš„è‰ºæœ¯é£æ ¼ï¼ˆå¤–éƒ¨çŠ¶æ€ï¼‰\n * @param {Function} props.onInputChange - è¾“å…¥å˜åŒ–å›è°ƒå‡½æ•°\n * @param {Function} props.onStyleChange - é£æ ¼å˜åŒ–å›è°ƒå‡½æ•°\n * @param {Function} props.onSubmit - æäº¤å›è°ƒå‡½æ•°\n * @param {Function} props.onClear - æ¸…é™¤å›è°ƒå‡½æ•°\n */\nconst LandingCard = memo(function LandingCard({\n  userInput,\n  selectedStyle,\n  onInputChange,\n  onStyleChange,\n  onSubmit,\n  onClear\n}) {\n  const [error, setError] = useState(null)\n  const [isSubmitting, setIsSubmitting] = useState(false)\n\n  // å¤„ç†è¾“å…¥å˜åŒ–ï¼ˆä½¿ç”¨useCallbackä¼˜åŒ–ï¼‰\n  const handleInputChange = useCallback((value) => {\n    onInputChange(value)\n    // è¾“å…¥å˜åŒ–æ—¶ç«‹å³æ¸…é™¤é”™è¯¯ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ\n    if (error) {\n      setError(null)\n    }\n  }, [onInputChange, error])\n\n  // å¤„ç†é£æ ¼å˜åŒ–ï¼ˆä½¿ç”¨useCallbackä¼˜åŒ–ï¼‰\n  const handleStyleChange = useCallback((style) => {\n    onStyleChange(style)\n    // é£æ ¼å˜åŒ–æ—¶ç«‹å³æ¸…é™¤é”™è¯¯ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ\n    if (error) {\n      setError(null)\n    }\n  }, [onStyleChange, error])\n\n  // å¤„ç†æ¸…é™¤ï¼ˆä½¿ç”¨useCallbackä¼˜åŒ–ï¼‰\n  const handleClear = useCallback(() => {\n    onClear()\n    setError(null)\n    setIsSubmitting(false)\n  }, [onClear])\n\n  // å¤„ç†æäº¤ï¼ˆä½¿ç”¨useCallbackä¼˜åŒ–ï¼‰\n  const handleSubmit = useCallback(async () => {\n    // éªŒè¯è¾“å…¥\n    const inputValidation = validateUserInput(userInput)\n    if (!inputValidation.valid) {\n      setError(inputValidation.error)\n      return\n    }\n\n    // éªŒè¯é£æ ¼\n    const styleValidation = validateStyle(selectedStyle)\n    if (!styleValidation.valid) {\n      setError(styleValidation.error)\n      return\n    }\n\n    // æ¸…é™¤é”™è¯¯ï¼Œè®¾ç½®æäº¤çŠ¶æ€\n    setError(null)\n    setIsSubmitting(true)\n\n    try {\n      // è°ƒç”¨çˆ¶ç»„ä»¶å›è°ƒ\n      await onSubmit(userInput.trim(), selectedStyle)\n    } catch (err) {\n      // å¦‚æœçˆ¶ç»„ä»¶å›è°ƒæŠ›å‡ºé”™è¯¯ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯\n      setError(err.message || 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•')\n    } finally {\n      setIsSubmitting(false)\n    }\n  }, [userInput, selectedStyle, onSubmit])\n\n  return (\n    <div className=\"bg-white/40 backdrop-blur-md border border-white/50 rounded-2xl shadow-xl max-w-full md:max-w-[1176px] mx-auto p-8 md:p-10\">\n      {/* Dream Input Section */}\n      <DreamInput\n        userInput={userInput}\n        error={error}\n        onInputChange={handleInputChange}\n      />\n\n      {/* Control Bar */}\n      <ControlBar\n        selectedStyle={selectedStyle}\n        onStyleChange={handleStyleChange}\n        onClear={handleClear}\n        onSubmit={handleSubmit}\n        isSubmitting={isSubmitting}\n        userInput={userInput}\n      />\n    </div>\n  )\n})\n\nexport default LandingCard\n\n","import React from 'react'\r\nimport { motion } from 'framer-motion'\r\n\r\n/**\r\n * Loadingç»„ä»¶\r\n * æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ŒåŒ…å«è¶£å‘³æ–‡æ¡ˆå’ŒåŠ¨ç”»\r\n *\r\n * @param {Object} props\r\n * @param {string} [props.message] - è‡ªå®šä¹‰Loadingæ–‡æ¡ˆï¼ˆå¯é€‰ï¼‰\r\n */\r\nexport default function Loading({ message }) {\r\n  // Loadingæ–‡æ¡ˆåº“\r\n  const loadingMessages = [\r\n    'æ­£åœ¨æ”¶é›†ç‹¬è§’å…½çš„çœ¼æ³ª...',\r\n    'æ­£åœ¨ç¼è¡¥äº‘æœµ...',\r\n    'æ­£åœ¨è°ƒè‰²æ¢¦å¢ƒ...',\r\n    'æ­£åœ¨å”¤é†’æ²‰ç¡çš„ç”»ç¬”...',\r\n    'æ­£åœ¨ç¼–ç»‡æ¢¦å¢ƒç¢ç‰‡...',\r\n    'æ­£åœ¨æ•æ‰æ˜Ÿå…‰...',\r\n    'æ­£åœ¨ç»˜åˆ¶ä½ çš„æ¢¦å¢ƒ...',\r\n  ]\r\n\r\n  // éšæœºé€‰æ‹©æ–‡æ¡ˆ\r\n  const displayMessage = message || loadingMessages[Math.floor(Math.random() * loadingMessages.length)]\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center min-h-[400px]\">\r\n      {/* äº‘æœµåŠ¨ç”» */}\r\n      <motion.div\r\n        className=\"cloudmorphism p-8 mb-6\"\r\n        animate={{\r\n          y: [0, -10, 0],\r\n          scale: [1, 1.05, 1],\r\n        }}\r\n        transition={{\r\n          duration: 3,\r\n          repeat: Infinity,\r\n          ease: 'easeInOut',\r\n        }}\r\n      >\r\n        <div className=\"text-6xl mb-4\">â˜ï¸</div>\r\n      </motion.div>\r\n\r\n      {/* Loadingæ–‡æ¡ˆ */}\r\n      <motion.p\r\n        className=\"text-2xl md:text-3xl font-baloo text-white text-glow text-center\"\r\n        animate={{\r\n          opacity: [0.7, 1, 0.7],\r\n        }}\r\n        transition={{\r\n          duration: 2,\r\n          repeat: Infinity,\r\n          ease: 'easeInOut',\r\n        }}\r\n      >\r\n        {displayMessage}\r\n      </motion.p>\r\n    </div>\r\n  )\r\n}\r\n\r\n","import React from 'react'\r\nimport { motion, AnimatePresence } from 'framer-motion'\r\n\r\n/**\r\n * å¼•å¯¼æ°”æ³¡ç»„ä»¶\r\n * éæ¢¦å¢ƒåœºæ™¯ä¸‹çš„å¼•å¯¼æç¤º\r\n *\r\n * @param {Object} props\r\n * @param {string} props.advice - å¼•å¯¼æ–‡æ¡ˆï¼ˆæ¥è‡ªAPIè¿”å›çš„adviceå­—æ®µï¼‰\r\n * @param {Function} props.onClose - å…³é—­å›è°ƒï¼ˆè¿”å›inputçŠ¶æ€ï¼‰\r\n */\r\nexport default function GuideBubble({ advice, onClose }) {\r\n  return (\r\n    <AnimatePresence>\r\n      <motion.div\r\n        className=\"fixed inset-0 z-50 flex items-center justify-center p-4\"\r\n        initial={{ opacity: 0 }}\r\n        animate={{ opacity: 1 }}\r\n        exit={{ opacity: 0 }}\r\n        onClick={onClose}\r\n      >\r\n        {/* èƒŒæ™¯é®ç½© */}\r\n        <motion.div\r\n          className=\"absolute inset-0 bg-black/20 backdrop-blur-sm\"\r\n          initial={{ opacity: 0 }}\r\n          animate={{ opacity: 1 }}\r\n          exit={{ opacity: 0 }}\r\n        />\r\n\r\n        {/* å¼•å¯¼æ°”æ³¡ */}\r\n        <motion.div\r\n          className=\"cloudmorphism p-6 md:p-8 max-w-md relative z-10 cursor-pointer\"\r\n          initial={{ x: -300, opacity: 0, scale: 0.8 }}\r\n          animate={{ x: 0, opacity: 1, scale: 1 }}\r\n          exit={{ x: 300, opacity: 0, scale: 0.8 }}\r\n          transition={{\r\n            type: 'spring',\r\n            stiffness: 300,\r\n            damping: 30,\r\n          }}\r\n          whileHover={{ scale: 1.05 }}\r\n          whileTap={{ scale: 0.95 }}\r\n          onClick={(e) => e.stopPropagation()}\r\n        >\r\n          {/* æµ®åŠ¨åŠ¨ç”» */}\r\n          <motion.div\r\n            animate={{\r\n              y: [0, -5, 0],\r\n            }}\r\n            transition={{\r\n              duration: 3,\r\n              repeat: Infinity,\r\n              ease: 'easeInOut',\r\n            }}\r\n          >\r\n            {/* å¼•å¯¼æ–‡æ¡ˆ */}\r\n            <p className=\"text-lg md:text-xl font-nunito text-white text-glow text-center mb-4\">\r\n              {advice}\r\n            </p>\r\n\r\n            {/* å…³é—­æç¤º */}\r\n            <p className=\"text-sm text-white/70 text-center\">\r\n              ç‚¹å‡»ä»»æ„ä½ç½®ç»§ç»­\r\n            </p>\r\n          </motion.div>\r\n        </motion.div>\r\n      </motion.div>\r\n    </AnimatePresence>\r\n  )\r\n}\r\n\r\n","/**\r\n * èŠ‚æµå‡½æ•°\r\n * é™åˆ¶å‡½æ•°è°ƒç”¨é¢‘ç‡ï¼Œåœ¨æŒ‡å®šæ—¶é—´é—´éš”å†…æœ€å¤šæ‰§è¡Œä¸€æ¬¡\r\n *\r\n * @param {Function} fn - éœ€è¦èŠ‚æµçš„å‡½æ•°\r\n * @param {number} delay - å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤100ms\r\n * @returns {Function} èŠ‚æµåçš„å‡½æ•°\r\n */\r\nexport function throttle(fn, delay = 100) {\r\n  let lastCallTime = 0\r\n  let timeoutId = null\r\n\r\n  return function (...args) {\r\n    const now = Date.now()\r\n    const timeSinceLastCall = now - lastCallTime\r\n\r\n    // å¦‚æœè·ç¦»ä¸Šæ¬¡è°ƒç”¨å·²ç»è¶…è¿‡å»¶è¿Ÿæ—¶é—´ï¼Œç«‹å³æ‰§è¡Œ\r\n    if (timeSinceLastCall >= delay) {\r\n      lastCallTime = now\r\n      fn.apply(this, args)\r\n    } else {\r\n      // å¦åˆ™ï¼Œæ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨ï¼Œè®¾ç½®æ–°çš„å®šæ—¶å™¨\r\n      if (timeoutId) {\r\n        clearTimeout(timeoutId)\r\n      }\r\n      timeoutId = setTimeout(() => {\r\n        lastCallTime = Date.now()\r\n        fn.apply(this, args)\r\n      }, delay - timeSinceLastCall)\r\n    }\r\n  }\r\n}\r\n\r\n","import { useState, useEffect } from 'react'\r\n\r\n/**\r\n * é™€èºä»ªHook\r\n * ç›‘å¬è®¾å¤‡æ–¹å‘å˜åŒ–ï¼Œè¿”å›å€¾æ–œè§’åº¦\r\n *\r\n * @returns {Object} { beta: number, gamma: number, isSupported: boolean }\r\n */\r\nexport function useDeviceOrientation() {\r\n  const [orientation, setOrientation] = useState({\r\n    beta: 0, // å‰åå€¾æ–œè§’åº¦ï¼ˆ-180 åˆ° 180ï¼‰\r\n    gamma: 0, // å·¦å³å€¾æ–œè§’åº¦ï¼ˆ-90 åˆ° 90ï¼‰\r\n    isSupported: false,\r\n  })\r\n\r\n  useEffect(() => {\r\n    // æ£€æµ‹è®¾å¤‡æ˜¯å¦æ”¯æŒé™€èºä»ª\r\n    if (typeof DeviceOrientationEvent === 'undefined') {\r\n      return\r\n    }\r\n\r\n    // iOS 13+ éœ€è¦è¯·æ±‚æƒé™\r\n    if (typeof DeviceOrientationEvent.requestPermission === 'function') {\r\n      DeviceOrientationEvent.requestPermission()\r\n        .then((response) => {\r\n          if (response === 'granted') {\r\n            setOrientation((prev) => ({ ...prev, isSupported: true }))\r\n            setupOrientationListener()\r\n          }\r\n        })\r\n        .catch(() => {\r\n          // æƒé™è¢«æ‹’ç»ï¼Œä½¿ç”¨é™çº§æ–¹æ¡ˆ\r\n        })\r\n    } else {\r\n      // Android æˆ–å…¶ä»–æ”¯æŒé™€èºä»ªçš„æµè§ˆå™¨\r\n      setOrientation((prev) => ({ ...prev, isSupported: true }))\r\n      setupOrientationListener()\r\n    }\r\n\r\n    function setupOrientationListener() {\r\n      const handleOrientation = (event) => {\r\n        setOrientation({\r\n          beta: event.beta || 0, // å‰åå€¾æ–œ\r\n          gamma: event.gamma || 0, // å·¦å³å€¾æ–œ\r\n          isSupported: true,\r\n        })\r\n      }\r\n\r\n      window.addEventListener('deviceorientation', handleOrientation)\r\n\r\n      // é¡µé¢ä¸å¯è§æ—¶åœæ­¢ç›‘å¬ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰\r\n      const handleVisibilityChange = () => {\r\n        if (document.hidden) {\r\n          window.removeEventListener('deviceorientation', handleOrientation)\r\n        } else {\r\n          window.addEventListener('deviceorientation', handleOrientation)\r\n        }\r\n      }\r\n\r\n      document.addEventListener('visibilitychange', handleVisibilityChange)\r\n\r\n      return () => {\r\n        window.removeEventListener('deviceorientation', handleOrientation)\r\n        document.removeEventListener('visibilitychange', handleVisibilityChange)\r\n      }\r\n    }\r\n\r\n    return setupOrientationListener()\r\n  }, [])\r\n\r\n  return orientation\r\n}\r\n\r\n","import { useState, useEffect, useCallback } from 'react'\r\nimport { throttle } from '../utils/throttle'\r\nimport { useDeviceOrientation } from './useDeviceOrientation'\r\n\r\n/**\r\n * è§†å·®Hook\r\n * æ”¯æŒæ¡Œé¢ç«¯é¼ æ ‡è§†å·®å’Œç§»åŠ¨ç«¯é™€èºä»ªè§†å·®\r\n *\r\n * @returns {Object} { rotateX: number, rotateY: number }\r\n */\r\nexport function useParallax() {\r\n  const [parallax, setParallax] = useState({ rotateX: 0, rotateY: 0 })\r\n  const { beta, gamma, isSupported: isGyroSupported } = useDeviceOrientation()\r\n\r\n  // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡\r\n  const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent)\r\n\r\n  // æ¡Œé¢ç«¯é¼ æ ‡è§†å·®\r\n  useEffect(() => {\r\n    if (isMobile && isGyroSupported) {\r\n      // ç§»åŠ¨ç«¯ä½¿ç”¨é™€èºä»ªï¼Œä¸ç›‘å¬é¼ æ ‡äº‹ä»¶\r\n      return\r\n    }\r\n\r\n    const handleMouseMove = throttle((e) => {\r\n      const { clientX, clientY } = e\r\n      const { innerWidth, innerHeight } = window\r\n\r\n      // è®¡ç®—é¼ æ ‡ç›¸å¯¹ä½ç½®ï¼ˆ-1 åˆ° 1ï¼‰\r\n      const rotateY = ((clientX / innerWidth) - 0.5) * 2\r\n      const rotateX = ((clientY / innerHeight) - 0.5) * -2\r\n\r\n      setParallax({ rotateX, rotateY })\r\n    }, 100) // æ¡Œé¢ç«¯100msèŠ‚æµ\r\n\r\n    window.addEventListener('mousemove', handleMouseMove)\r\n\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleMouseMove)\r\n    }\r\n  }, [isMobile, isGyroSupported])\r\n\r\n  // ç§»åŠ¨ç«¯é™€èºä»ªè§†å·®\r\n  useEffect(() => {\r\n    if (!isMobile || !isGyroSupported) {\r\n      return\r\n    }\r\n\r\n    // å°†é™€èºä»ªè§’åº¦è½¬æ¢ä¸ºè§†å·®å€¼ï¼ˆ-1 åˆ° 1ï¼‰\r\n    // beta: -180 åˆ° 180ï¼Œgamma: -90 åˆ° 90\r\n    const rotateX = Math.max(-1, Math.min(1, beta / 45)) // é™åˆ¶èŒƒå›´\r\n    const rotateY = Math.max(-1, Math.min(1, gamma / 45)) // é™åˆ¶èŒƒå›´\r\n\r\n    // ä½¿ç”¨èŠ‚æµå¤„ç†ï¼ˆç§»åŠ¨ç«¯200msï¼‰\r\n    const throttledUpdate = throttle(() => {\r\n      setParallax({ rotateX, rotateY })\r\n    }, 200)\r\n\r\n    throttledUpdate()\r\n  }, [beta, gamma, isMobile, isGyroSupported])\r\n\r\n  return parallax\r\n}\r\n\r\n","import React from 'react'\r\nimport { motion } from 'framer-motion'\r\nimport { ArrowLeft } from 'lucide-react'\r\nimport { useParallax } from '../hooks/useParallax'\r\n\r\n/**\r\n * ç«‹ä½“ç»˜æœ¬ç»„ä»¶\r\n * å±•ç¤ºç”Ÿæˆçš„æ¢¦å¢ƒç”»ä½œå’Œå¿ƒç†åˆ†æ\r\n *\r\n * @param {Object} props\r\n * @param {string} props.imageUrl - ç”Ÿæˆçš„å›¾ç‰‡URL\r\n * @param {string} props.diagnosis - å¿ƒç†åˆ†æè¯Šæ–­æ–‡æ¡ˆ\r\n * @param {string} props.advice - å»ºè®®æ–‡æ¡ˆ\r\n * @param {string[]} props.keywords - å…³é”®è¯æ ‡ç­¾æ•°ç»„\r\n * @param {Function} props.onBack - è¿”å›æŒ‰é’®ç‚¹å‡»å›è°ƒå‡½æ•°\r\n */\r\nexport default function DreamBook({ imageUrl, diagnosis, advice, keywords, onBack }) {\r\n  const { rotateX, rotateY } = useParallax()\r\n\r\n  return (\r\n    <div className=\"w-full max-w-[1029px] mx-auto relative\">\r\n      {/* è¿”å›æŒ‰é’® - ä½äºå·¦ä¸Šè§’ */}\r\n      <motion.button\r\n        onClick={onBack}\r\n        className=\"fixed top-4 md:top-8 left-4 md:left-8 flex items-center gap-2 text-xl md:text-2xl text-indigo-800 font-medium transition-all duration-200 hover:text-indigo-900 hover:scale-105 active:scale-95 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2 rounded-lg px-2 py-1 z-50\"\r\n        initial={{ opacity: 0, x: -20 }}\r\n        animate={{ opacity: 1, x: 0 }}\r\n        exit={{ opacity: 0, scale: 0.9 }}\r\n        transition={{ delay: 0.3 }}\r\n        aria-label=\"è¿”å›æ¢¦å¢ƒè¾“å…¥ç•Œé¢\"\r\n        tabIndex={0}\r\n        onKeyDown={(e) => {\r\n          if (e.key === 'Enter' || e.key === ' ') {\r\n            e.preventDefault()\r\n            onBack()\r\n          }\r\n        }}\r\n      >\r\n        <ArrowLeft className=\"w-5 h-5 md:w-6 md:h-6\" />\r\n        <span>è¿”å›</span>\r\n      </motion.button>\r\n\r\n      {/* ç¿»ä¹¦åŠ¨ç”»å®¹å™¨ */}\r\n      <motion.div\r\n        className=\"relative\"\r\n        initial={{ rotateY: -90, opacity: 0 }}\r\n        animate={{ rotateY: 0, opacity: 1 }}\r\n        transition={{ duration: 1, ease: 'easeOut' }}\r\n      >\r\n        {/* ä¹¦æœ¬å®¹å™¨ */}\r\n        <div className=\"cloudmorphism p-[28px] md:p-[35px]\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-[28px]\">\r\n            {/* å·¦ä¾§é¡µé¢ï¼šå¿ƒç†åˆ†æ */}\r\n            <motion.div\r\n              className=\"p-[28px] bg-white/20 rounded-lg backdrop-blur-sm\"\r\n              style={{\r\n                perspective: '1000px',\r\n              }}\r\n            >\r\n              <h3\r\n                className=\"text-[27.5625px] md:text-[36.75px] font-baloo text-indigo-900 mb-4\"\r\n                style={{\r\n                  textShadow: '0 2px 8px rgba(99, 102, 241, 0.2), 0 0 20px rgba(139, 92, 246, 0.15)',\r\n                  filter: 'drop-shadow(0 2px 4px rgba(99, 102, 241, 0.1))'\r\n                }}\r\n              >\r\n                æ¢¦å¢ƒè¯Šæ–­ä¹¦\r\n              </h3>\r\n              <div className=\"text-indigo-900 font-nunito leading-relaxed whitespace-pre-wrap text-[18.28px] md:text-[20.32px]\">\r\n                {diagnosis}\r\n              </div>\r\n              {advice && (\r\n                <div className=\"mt-4 pt-4 border-t border-white/20\">\r\n                  <p className=\"text-indigo-600/90 text-[18.28px] md:text-[20.32px]\">\r\n                    âœ¨ {advice}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </motion.div>\r\n\r\n            {/* å³ä¾§é¡µé¢ï¼šç”Ÿæˆå›¾ç‰‡ */}\r\n            <motion.div\r\n              className=\"relative\"\r\n              style={{\r\n                perspective: '1000px',\r\n                transform: `perspective(1000px) rotateX(${rotateX * 10}deg) rotateY(${rotateY * 10}deg)`,\r\n                transformStyle: 'preserve-3d',\r\n              }}\r\n            >\r\n              <motion.img\r\n                src={imageUrl}\r\n                alt=\"ç”Ÿæˆçš„æ¢¦å¢ƒç”»ä½œ\"\r\n                className=\"w-full h-auto rounded-lg shadow-2xl\"\r\n                loading=\"lazy\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                transition={{ delay: 0.5 }}\r\n                onError={(e) => {\r\n                  e.target.src = 'data:image/svg+xml,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"400\" height=\"400\"%3E%3Crect fill=\"%23ccc\" width=\"400\" height=\"400\"/%3E%3Ctext fill=\"%23999\" font-family=\"sans-serif\" font-size=\"18\" x=\"50%25\" y=\"50%25\" text-anchor=\"middle\" dy=\".3em\"%3Eå›¾ç‰‡åŠ è½½å¤±è´¥%3C/text%3E%3C/svg%3E'\r\n                }}\r\n              />\r\n            </motion.div>\r\n          </div>\r\n\r\n          {/* åº•éƒ¨ä¹¦ç­¾ï¼šå…³é”®è¯æ ‡ç­¾ */}\r\n          {keywords && keywords.length > 0 && (\r\n            <motion.div\r\n              className=\"mt-[28px] flex flex-wrap gap-[10.5px] justify-center\"\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ delay: 0.8 }}\r\n            >\r\n              {keywords.map((keyword, index) => (\r\n                <motion.span\r\n                  key={index}\r\n                  className=\"px-4 py-2 bg-indigo-500/20 backdrop-blur-md rounded-full text-indigo-800 text-[18.29px] md:text-[20.57px] font-nunito border border-indigo-400/30 shadow-md hover:bg-indigo-500/30 transition-colors\"\r\n                  initial={{ opacity: 0, scale: 0 }}\r\n                  animate={{ opacity: 1, scale: 1 }}\r\n                  transition={{ delay: 0.9 + index * 0.1 }}\r\n                >\r\n                  #{keyword}\r\n                </motion.span>\r\n              ))}\r\n            </motion.div>\r\n          )}\r\n        </div>\r\n      </motion.div>\r\n    </div>\r\n  )\r\n}\r\n\r\n","/**\n * é”™è¯¯å¤„ç†å·¥å…·å‡½æ•°\n */\n\n/**\n * APIé”™è¯¯ç±»\n * ç»§æ‰¿è‡ªErrorï¼ŒåŒ…å«çŠ¶æ€ç ä¿¡æ¯\n */\nexport class ApiError extends Error {\n  constructor(statusCode, message) {\n    super(message)\n    this.name = 'ApiError'\n    this.statusCode = statusCode\n  }\n}\n\n/**\n * ç»Ÿä¸€é”™è¯¯å¤„ç†å‡½æ•°\n * å°†å„ç§é”™è¯¯è½¬æ¢ä¸ºç”¨æˆ·å‹å¥½çš„æç¤ºä¿¡æ¯\n *\n * @param {Error} error - é”™è¯¯å¯¹è±¡\n * @returns {Object} { message: string, type: string }\n */\nexport function handleError(error) {\n  let errorMessage = 'å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'\n  let errorType = 'UNKNOWN_ERROR'\n\n  // è¯†åˆ«é…ç½®é”™è¯¯ï¼ˆç¯å¢ƒå˜é‡æœªé…ç½®ï¼‰\n  if (error.message && error.message.includes('APIé…ç½®é”™è¯¯')) {\n    errorType = 'CONFIG_ERROR'\n    errorMessage = error.message // ç›´æ¥æ˜¾ç¤ºåŸå§‹é”™è¯¯ä¿¡æ¯\n    // ç”Ÿäº§ç¯å¢ƒä¹Ÿæ˜¾ç¤ºè¯¦ç»†é”™è¯¯ï¼ˆä¾¿äºè°ƒè¯•ï¼‰\n    console.error('é…ç½®é”™è¯¯:', {\n      message: error.message,\n      hint: 'è¯·æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼šVITE_COZE_BOT_ID å’Œ VITE_COZE_TOKEN',\n      env: {\n        mode: import.meta.env.MODE,\n        botId: import.meta.env.VITE_COZE_BOT_ID ? 'å·²é…ç½®' : 'æœªé…ç½®',\n        token: import.meta.env.VITE_COZE_TOKEN ? 'å·²é…ç½®' : 'æœªé…ç½®',\n      }\n    })\n    return {\n      message: errorMessage,\n      type: errorType,\n      originalError: error,\n    }\n  }\n\n  if (error instanceof ApiError) {\n    // APIé”™è¯¯\n    errorType = 'API_ERROR'\n    switch (error.statusCode) {\n      case 400:\n        errorMessage = 'è¾“å…¥å†…å®¹æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥'\n        break\n      case 401:\n      case 403:\n        // 401 å’Œ 403 éƒ½å¯èƒ½æ˜¯è®¤è¯é—®é¢˜ï¼Œ4101 é”™è¯¯ç ä¹Ÿä¼šè¿”å›è¿™äº›çŠ¶æ€ç \n        if (error.message && (error.message.includes('4101') || error.message.includes('token ä¸åˆæ³•') || error.message.includes('Bearer token'))) {\n          errorMessage = 'Token è®¤è¯å¤±è´¥ï¼šè¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®ã€æ˜¯å¦å·²è¿‡æœŸï¼Œæˆ–æ˜¯å¦éœ€è¦åœ¨ Coze å¹³å°é‡æ–°ç”Ÿæˆ Token'\n        } else {\n          errorMessage = 'è®¤è¯å¤±è´¥ï¼šè¯·æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®æˆ–å·²è¿‡æœŸ'\n        }\n        // å¼€å‘ç¯å¢ƒæä¾›æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯\n        if (import.meta.env.DEV) {\n          console.error('è®¤è¯é”™è¯¯è¯¦æƒ…:', {\n            statusCode: error.statusCode,\n            message: error.message,\n            hint: 'è¯·æ£€æŸ¥ .env.development æ–‡ä»¶ä¸­çš„ VITE_COZE_TOKEN æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æ²¡æœ‰å¤šä½™ç©ºæ ¼',\n            documentation: 'å‚è€ƒ https://coze.cn/docs/developer_guides/authentication',\n          })\n        }\n        break\n      case 404:\n        errorMessage = 'API åœ°å€ä¸å­˜åœ¨ï¼šè¯·æ£€æŸ¥ API URL æ˜¯å¦æ­£ç¡®'\n        break\n      case 429:\n        errorMessage = 'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•'\n        break\n      case 500:\n        errorMessage = 'æœåŠ¡å™¨å¼‚å¸¸ï¼Œè¯·ç¨åé‡è¯•'\n        break\n      case 502:\n      case 503:\n        errorMessage = 'æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•'\n        break\n      case 504:\n        errorMessage = 'ç”Ÿæˆæ—¶é—´è¾ƒé•¿ï¼Œè¯·ç¨å€™...'\n        break\n      default:\n        errorMessage = error.message || `APIé”™è¯¯ (${error.statusCode})`\n    }\n  } else if (error.message && error.message.includes('è¶…æ—¶') || error.name === 'TimeoutError') {\n    // è¶…æ—¶é”™è¯¯\n    errorType = 'TIMEOUT_ERROR'\n    errorMessage = error.message || 'ç”Ÿæˆæ—¶é—´è¾ƒé•¿ï¼Œè¯·ç¨å€™...'\n    // å¼€å‘ç¯å¢ƒæä¾›æ›´è¯¦ç»†çš„æç¤º\n    if (import.meta.env.DEV) {\n      console.error('è¶…æ—¶é”™è¯¯è¯¦æƒ…:', {\n        message: error.message,\n        hint: 'ç”Ÿæˆå›¾ç‰‡å¯èƒ½éœ€è¦3-5åˆ†é’Ÿï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å¢åŠ è¶…æ—¶æ—¶é—´',\n      })\n    }\n  } else if (error.message && error.message.includes('æ ¼å¼') || error.name === 'ValidationError') {\n    // æ•°æ®æ ¼å¼é”™è¯¯æˆ–éªŒè¯é”™è¯¯\n    errorType = 'VALIDATION_ERROR'\n    errorMessage = error.message || 'æ•°æ®æ ¼å¼å¼‚å¸¸ï¼Œè¯·é‡è¯•'\n  } else if (error.message && error.message.includes('ç½‘ç»œ')) {\n    // ç½‘ç»œé”™è¯¯ï¼ˆçœŸæ­£çš„ç½‘ç»œè¿æ¥é—®é¢˜ï¼‰\n    errorType = 'NETWORK_ERROR'\n    errorMessage = 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•'\n  }\n\n  // å¼€å‘ç¯å¢ƒè®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯\n  if (import.meta.env.DEV) {\n    console.error('é”™è¯¯è¯¦æƒ…:', {\n      type: errorType,\n      message: errorMessage,\n      originalError: error,\n    })\n  }\n\n  return {\n    message: errorMessage,\n    type: errorType,\n    originalError: error,\n  }\n}\n\n","import { ApiError, handleError } from '../utils/errorHandler'\r\nimport { validateUserInput, validateStyle, validateApiResponse } from '../utils/dataValidator'\r\n\r\n/**\r\n * æ¢¦å¢ƒç”Ÿæˆæ¥å£ï¼ˆåŒ…å«æ¢¦å¢ƒåˆ¤æ–­ï¼‰\r\n * ç»Ÿä¸€çš„APIæ¥å£ï¼ŒåŒ…å«æ¢¦å¢ƒåˆ¤æ–­ã€Promptä¼˜åŒ–ã€å›¾ç‰‡ç”Ÿæˆã€å¿ƒç†åˆ†æç­‰å®Œæ•´æµç¨‹\r\n *\r\n * @param {string} userInput - ç”¨æˆ·è¾“å…¥çš„æ¢¦å¢ƒæè¿°\r\n * @param {string} style - ç”¨æˆ·é€‰æ‹©çš„é£æ ¼ï¼ˆGhibliã€Van Goghã€Cthulhuã€Minimalistã€Cyber_Xianxiaï¼‰\r\n * @returns {Promise<Object>} ç”Ÿæˆç»“æœ { image_url, diagnosis, advice, keywords }\r\n * @throws {Error} ç½‘ç»œé”™è¯¯ã€è¶…æ—¶é”™è¯¯ã€APIé”™è¯¯\r\n */\r\nexport async function generateDream(userInput, style) {\r\n  // 1. å‚æ•°éªŒè¯\r\n  const inputValidation = validateUserInput(userInput)\r\n  if (!inputValidation.valid) {\r\n    throw new Error(inputValidation.error)\r\n  }\r\n\r\n  const styleValidation = validateStyle(style)\r\n  if (!styleValidation.valid) {\r\n    throw new Error(styleValidation.error)\r\n  }\r\n\r\n  // 2. è·å–ç¯å¢ƒå˜é‡\r\n  // ä½¿ç”¨ Bot (Agent) å¯¹è¯æ¥å£ï¼ŒURL å›ºå®šä¸º chat æ¥å£\r\n  const apiUrl = import.meta.env.VITE_COZE_API_URL || 'https://api.coze.cn/open_api/v2/chat'\r\n  const botId = import.meta.env.VITE_COZE_BOT_ID\r\n  let token = import.meta.env.VITE_COZE_TOKEN\r\n\r\n  if (!botId || !token) {\r\n    throw new Error('APIé…ç½®é”™è¯¯ï¼šè¯·æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€è¦ VITE_COZE_BOT_ID å’Œ VITE_COZE_TOKENï¼‰')\r\n  }\r\n\r\n  // æ¸…ç† Tokenï¼ˆç§»é™¤å‰åç©ºæ ¼å’Œæ¢è¡Œç¬¦ï¼‰\r\n  token = token.trim().replace(/\\n/g, '').replace(/\\r/g, '')\r\n\r\n  // æ ¹æ® Token æ ¼å¼ç¡®å®šè®¤è¯æ–¹å¼\r\n  // æ³¨æ„ï¼šæ ¹æ® Coze API æ–‡æ¡£ï¼Œå³ä½¿ä½¿ç”¨ PAT Tokenï¼Œä¹Ÿå¯èƒ½éœ€è¦ä½¿ç”¨ Bearer å‰ç¼€\r\n  let authPrefix = 'Bearer' // é»˜è®¤ä½¿ç”¨ Bearer\r\n  // æŸäº› Coze API ç‰ˆæœ¬å¯èƒ½éœ€è¦ Pat å‰ç¼€ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨ Bearer\r\n  // å¦‚æœé‡åˆ° 4101 é”™è¯¯ï¼Œå¯ä»¥å°è¯•åˆ‡æ¢è®¤è¯æ–¹å¼\r\n  if (token.startsWith('pat_')) {\r\n    // PAT Token é€šå¸¸ä¹Ÿä½¿ç”¨ Bearer å‰ç¼€ï¼ˆæ ¹æ® Coze API æ–‡æ¡£ï¼‰\r\n    authPrefix = 'Bearer'\r\n    // å¦‚æœ Bearer ä¸å·¥ä½œï¼Œå¯ä»¥å°è¯• Patï¼ˆå–æ¶ˆä¸‹é¢çš„æ³¨é‡Šï¼‰\r\n    // authPrefix = 'Pat'\r\n  } else if (token.startsWith('cztei_')) {\r\n    authPrefix = 'Bearer' // cztei_ æ ¼å¼ä½¿ç”¨ Bearer å‰ç¼€\r\n  }\r\n\r\n  // å¼€å‘ç¯å¢ƒä¸‹éªŒè¯ Token æ ¼å¼\r\n  if (import.meta.env.DEV) {\r\n    const isValidFormat = token.startsWith('pat_') || token.startsWith('cztei_')\r\n    if (!isValidFormat) {\r\n      console.warn('âš ï¸ è­¦å‘Š: Token æ ¼å¼å¯èƒ½ä¸æ­£ç¡®ï¼Œåº”è¯¥ä»¥ \"pat_\" æˆ– \"cztei_\" å¼€å¤´')\r\n    }\r\n    if (token.length < 50) {\r\n      console.warn('âš ï¸ è­¦å‘Š: Token é•¿åº¦å¯èƒ½ä¸æ­£ç¡®ï¼Œé€šå¸¸åº”è¯¥è¶…è¿‡ 50 ä¸ªå­—ç¬¦')\r\n    }\r\n    console.log('Token ä¿¡æ¯:', {\r\n      prefix: token.substring(0, 15) + '...',\r\n      length: token.length,\r\n      hasSpaces: token.includes(' '),\r\n      hasNewlines: token.includes('\\n') || token.includes('\\r'),\r\n      format: token.startsWith('pat_') ? 'PAT' : token.startsWith('cztei_') ? 'Bearer' : 'æœªçŸ¥',\r\n      authPrefix: authPrefix,\r\n    })\r\n  }\r\n\r\n  // 3. æ„å»ºè¯·æ±‚\r\n  // æ ¹æ® Coze Bot å¯¹è¯æ¥å£æ–‡æ¡£ï¼Œä½¿ç”¨ bot_id å’Œ query å­—æ®µ\r\n  // å°†ç”¨æˆ·è¾“å…¥å’Œé£æ ¼ç»„åˆæˆå®Œæ•´çš„æŸ¥è¯¢å†…å®¹\r\n  const queryText = `${userInput.trim()}\\né£æ ¼: ${style}`\r\n\r\n  const requestBody = {\r\n    bot_id: botId,\r\n    user: 'dream_painter_user', // ç”¨æˆ·æ ‡è¯†ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹\r\n    query: queryText,\r\n    stream: false, // ä¸ä½¿ç”¨æµå¼å“åº”\r\n    // å¦‚æœéœ€è¦ä¼ é€’é¢å¤–å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ extra å­—æ®µ\r\n    // extra: {\r\n    //   style: style,\r\n    //   user_input: userInput.trim(),\r\n    // }\r\n  }\r\n\r\n  // æ ¹æ® Token æ ¼å¼è‡ªåŠ¨é€‰æ‹©è®¤è¯æ–¹å¼\r\n  const requestOptions = {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      // æ ¹æ® Token æ ¼å¼è‡ªåŠ¨é€‰æ‹©è®¤è¯å‰ç¼€\r\n      'Authorization': `${authPrefix} ${token}`,\r\n    },\r\n    body: JSON.stringify(requestBody),\r\n  }\r\n\r\n  // å¼€å‘ç¯å¢ƒä¸‹æ‰“å°è®¤è¯ä¿¡æ¯ï¼ˆä¸æ˜¾ç¤ºå®Œæ•´ Tokenï¼‰\r\n  if (import.meta.env.DEV) {\r\n    console.log('è¯·æ±‚é…ç½®:', {\r\n      url: apiUrl,\r\n      headers: {\r\n        'Content-Type': requestOptions.headers['Content-Type'],\r\n        'Authorization': `${authPrefix} ${token.substring(0, 15)}...`,\r\n      },\r\n      bodyKeys: Object.keys(requestBody),\r\n      authPrefix: authPrefix,\r\n      tokenFormat: token.startsWith('pat_') ? 'PAT' : token.startsWith('cztei_') ? 'cztei' : 'æœªçŸ¥',\r\n    })\r\n  }\r\n\r\n  // 4. åˆ›å»ºAbortControllerç”¨äºè¶…æ—¶æ§åˆ¶\r\n  // ç”Ÿæˆå›¾ç‰‡éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆåŒ…å«åˆ¤æ–­ã€ä¼˜åŒ–ã€ç”Ÿå›¾ã€åˆ†æç­‰ï¼‰ï¼Œè®¾ç½®æ›´é•¿çš„è¶…æ—¶æ—¶é—´\r\n  const controller = new AbortController()\r\n  const timeoutDuration = 180000 // 180ç§’ï¼ˆ3åˆ†é’Ÿï¼‰è¶…æ—¶ï¼Œå› ä¸ºç”Ÿæˆå›¾ç‰‡éœ€è¦è¾ƒé•¿æ—¶é—´\r\n  const timeoutId = setTimeout(() => {\r\n    if (import.meta.env.DEV) {\r\n      console.warn('è¯·æ±‚è¶…æ—¶:', {\r\n        duration: timeoutDuration / 1000 + 'ç§’',\r\n        hint: 'ç”Ÿæˆå›¾ç‰‡å¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å¢åŠ è¶…æ—¶æ—¶é—´',\r\n      })\r\n    }\r\n    controller.abort()\r\n  }, timeoutDuration)\r\n\r\n  try {\r\n    // 5. å‘é€è¯·æ±‚\r\n    const requestStartTime = Date.now()\r\n    if (import.meta.env.DEV) {\r\n      console.log('å¼€å§‹å‘é€ API è¯·æ±‚:', {\r\n        url: apiUrl,\r\n        botId: botId,\r\n        query: queryText.substring(0, 50) + '...',\r\n        timeout: timeoutDuration / 1000 + 'ç§’',\r\n      })\r\n    }\r\n\r\n    const response = await fetch(apiUrl, {\r\n      ...requestOptions,\r\n      signal: controller.signal,\r\n    })\r\n\r\n    const requestDuration = Date.now() - requestStartTime\r\n    clearTimeout(timeoutId)\r\n\r\n    if (import.meta.env.DEV) {\r\n      console.log('API è¯·æ±‚å®Œæˆ:', {\r\n        duration: requestDuration + 'ms',\r\n        status: response.status,\r\n        statusText: response.statusText,\r\n      })\r\n    }\r\n\r\n    // 6. å¤„ç†å“åº”\r\n    if (!response.ok) {\r\n      let errorData = {}\r\n      try {\r\n        const text = await response.text()\r\n        errorData = text ? JSON.parse(text) : {}\r\n      } catch (e) {\r\n        // å¦‚æœè§£æå¤±è´¥ï¼Œä½¿ç”¨ç©ºå¯¹è±¡\r\n        if (import.meta.env.DEV) {\r\n          console.error('è§£æé”™è¯¯å“åº”å¤±è´¥:', e)\r\n        }\r\n      }\r\n\r\n      // è¯¦ç»†é”™è¯¯ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰\r\n      if (import.meta.env.DEV) {\r\n        console.error('API é”™è¯¯è¯¦æƒ…:', {\r\n          status: response.status,\r\n          statusText: response.statusText,\r\n          errorData: errorData,\r\n          requestUrl: apiUrl,\r\n          requestBody: requestBody,\r\n          tokenPrefix: token ? token.substring(0, 10) + '...' : 'æœªè®¾ç½®',\r\n          hint: 'å¦‚æœé‡åˆ°401æˆ–4101é”™è¯¯ï¼Œè¯·æ£€æŸ¥Tokenæ˜¯å¦æ­£ç¡®ï¼›å¦‚æœé‡åˆ°400é”™è¯¯ï¼Œè¯·æ£€æŸ¥bot_idå’Œè¯·æ±‚å‚æ•°æ ¼å¼',\r\n        })\r\n      }\r\n\r\n      // å¤„ç† Coze API çš„é”™è¯¯ç \r\n      let errorMessage = errorData.msg || errorData.message || errorData.error || `APIè¯·æ±‚å¤±è´¥: ${response.status} ${response.statusText}`\r\n\r\n      // å¦‚æœæ˜¯ 4101 é”™è¯¯ï¼ˆToken ä¸åˆæ³•ï¼‰ï¼Œæä¾›æ›´è¯¦ç»†çš„æç¤º\r\n      if (errorData.code === 4101 || errorMessage.includes('Bearer token') || errorMessage.includes('token ä¸åˆæ³•')) {\r\n        errorMessage = 'Token è®¤è¯å¤±è´¥ï¼ˆ4101ï¼‰ï¼šè¯·æ£€æŸ¥ä»¥ä¸‹äº‹é¡¹ï¼š\\n1. Token æ˜¯å¦æ­£ç¡®ï¼ˆç¡®ä¿æ²¡æœ‰å¤šä½™ç©ºæ ¼ï¼‰\\n2. Token æ˜¯å¦å·²è¿‡æœŸ\\n3. æ˜¯å¦éœ€è¦åœ¨ Coze å¹³å°é‡æ–°ç”Ÿæˆ Token\\n4. å‚è€ƒæ–‡æ¡£ï¼šhttps://coze.cn/docs/developer_guides/authentication'\r\n\r\n        // å¼€å‘ç¯å¢ƒä¸‹æä¾›è¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯\r\n        if (import.meta.env.DEV) {\r\n          console.error('4101 è®¤è¯é”™è¯¯è¯Šæ–­:', {\r\n            tokenPrefix: token ? token.substring(0, 20) + '...' : 'æœªè®¾ç½®',\r\n            tokenLength: token ? token.length : 0,\r\n            tokenFormat: token ? (token.startsWith('pat_') ? 'PAT' : token.startsWith('cztei_') ? 'cztei' : 'æœªçŸ¥') : 'æœªè®¾ç½®',\r\n            tokenStartsWithPat: token ? token.startsWith('pat_') : false,\r\n            tokenStartsWithCztei: token ? token.startsWith('cztei_') : false,\r\n            hasSpaces: token ? token.includes(' ') : false,\r\n            authPrefix: authPrefix,\r\n            authorizationHeader: `${authPrefix} ${token.substring(0, 15)}...`,\r\n            hint: 'å¦‚æœ Token æ ¼å¼æ­£ç¡®ä½†ä»ç„¶å¤±è´¥ï¼Œå¯èƒ½éœ€è¦ï¼š\\n1. åœ¨ Coze å¹³å°é‡æ–°ç”Ÿæˆ Token\\n2. æ£€æŸ¥ Token æƒé™è®¾ç½®\\n3. ç¡®è®¤ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ API ç«¯ç‚¹\\n4. å°è¯•ä½¿ç”¨ Pat å‰ç¼€è€Œä¸æ˜¯ Bearerï¼ˆå¦‚æœæ˜¯ PAT Tokenï¼‰',\r\n            suggestion: token && token.startsWith('pat_')\r\n              ? 'PAT Token æ£€æµ‹åˆ°ï¼Œå¦‚æœ Bearer ä¸å·¥ä½œï¼Œå¯ä»¥å°è¯•ä¿®æ”¹ä»£ç ä½¿ç”¨ Pat å‰ç¼€'\r\n              : 'è¯·ç¡®è®¤ Token æ ¼å¼å’Œè®¤è¯æ–¹å¼æ˜¯å¦æ­£ç¡®',\r\n          })\r\n        }\r\n      }\r\n\r\n      throw new ApiError(\r\n        response.status,\r\n        errorMessage\r\n      )\r\n    }\r\n\r\n    const data = await response.json()\r\n\r\n    // å¼€å‘ç¯å¢ƒä¸‹æ‰“å°å®é™…è¿”å›çš„æ•°æ®\r\n    if (import.meta.env.DEV) {\r\n      console.log('API å“åº”æ•°æ®:', data)\r\n      if (data.messages && Array.isArray(data.messages)) {\r\n        console.log('Messages è¯¦æƒ…:', {\r\n          count: data.messages.length,\r\n          types: data.messages.map(m => ({ type: m.type, role: m.role, hasContent: !!m.content })),\r\n          contents: data.messages\r\n            .filter(m => m.content)\r\n            .map(m => ({ type: m.type, content: typeof m.content === 'string' ? m.content.substring(0, 200) : m.content })),\r\n        })\r\n      }\r\n    }\r\n\r\n    // 7. å¤„ç† Bot æ¥å£çš„å“åº”æ ¼å¼\r\n    // Bot æ¥å£è¿”å› Coze æ ‡å‡†æ ¼å¼ï¼š{ code, conversation_id, messages: [...], msg }\r\n    // éœ€è¦ä» messages æ•°ç»„ä¸­æå–æ•°æ®\r\n    let extractedData = null\r\n\r\n    if (data.messages && Array.isArray(data.messages) && data.messages.length > 0) {\r\n      // ç­–ç•¥1: æŸ¥æ‰¾ type ä¸º \"answer\" çš„æ¶ˆæ¯ï¼ˆä¸»è¦å›ç­”å†…å®¹ï¼‰\r\n      let answerMessage = data.messages.find(msg => msg.type === 'answer' && msg.content)\r\n\r\n      // ç­–ç•¥2: å¦‚æœæ²¡æ‰¾åˆ° answerï¼ŒæŸ¥æ‰¾æ‰€æœ‰åŒ…å« content çš„æ¶ˆæ¯ï¼ˆæ’é™¤ function_call å’Œ tool_responseï¼‰\r\n      if (!answerMessage) {\r\n        answerMessage = data.messages.find(msg =>\r\n          msg.content &&\r\n          msg.type !== 'function_call' &&\r\n          msg.type !== 'tool_response' &&\r\n          msg.type !== 'verbose'\r\n        )\r\n      }\r\n\r\n      // ç­–ç•¥3: éå†æ‰€æœ‰æ¶ˆæ¯ï¼ŒæŸ¥æ‰¾åŒ…å« JSON æ ¼å¼çš„å†…å®¹\r\n      if (answerMessage && answerMessage.content) {\r\n        const content = answerMessage.content\r\n\r\n        // å°è¯•è§£æä¸º JSONï¼ˆBot å¯èƒ½è¿”å› JSON å­—ç¬¦ä¸²ï¼‰\r\n        try {\r\n          const parsedContent = JSON.parse(content)\r\n          // å¦‚æœè§£ææˆåŠŸä¸”åŒ…å«é¢„æœŸå­—æ®µï¼Œä½¿ç”¨è§£æåçš„æ•°æ®\r\n          if (parsedContent && typeof parsedContent === 'object') {\r\n            // æ£€æŸ¥æ˜¯å¦åŒ…å«å›¾ç‰‡ URLï¼ˆå¯èƒ½åœ¨ image_url å­—æ®µä¸­ï¼Œæˆ–è€…åœ¨å…¶ä»–å­—æ®µä¸­ï¼‰\r\n            if (parsedContent.image_url || parsedContent.diagnosis || parsedContent.advice) {\r\n              extractedData = parsedContent\r\n            }\r\n          }\r\n        } catch (e) {\r\n          // ä¸æ˜¯ JSON æ ¼å¼ï¼Œç»§ç»­æŸ¥æ‰¾\r\n        }\r\n      }\r\n\r\n      // ç­–ç•¥4: å¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œéå†æ‰€æœ‰æ¶ˆæ¯æŸ¥æ‰¾ JSON æ ¼å¼çš„å†…å®¹\r\n      if (!extractedData) {\r\n        for (const msg of data.messages) {\r\n          if (msg.content && typeof msg.content === 'string') {\r\n            // å°è¯•è§£æä¸º JSON\r\n            try {\r\n              const parsed = JSON.parse(msg.content)\r\n              if (parsed && typeof parsed === 'object') {\r\n                // æ£€æŸ¥æ˜¯å¦åŒ…å«é¢„æœŸçš„å­—æ®µï¼ˆimage_url, diagnosis, advice ç­‰ï¼‰\r\n                if (parsed.image_url !== undefined ||\r\n                    parsed.diagnosis !== undefined ||\r\n                    parsed.advice !== undefined ||\r\n                    parsed.keywords !== undefined) {\r\n                  extractedData = parsed\r\n                  if (import.meta.env.DEV) {\r\n                    console.log('âœ… ä»æ¶ˆæ¯ä¸­æå–åˆ°æ•°æ®:', {\r\n                      messageType: msg.type,\r\n                      messageRole: msg.role,\r\n                      extractedFields: Object.keys(parsed),\r\n                    })\r\n                  }\r\n                  break\r\n                }\r\n              }\r\n            } catch (e) {\r\n              // ä¸æ˜¯ JSONï¼Œç»§ç»­æŸ¥æ‰¾\r\n              continue\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // ç­–ç•¥5: å¦‚æœä»ç„¶æ²¡æœ‰æ‰¾åˆ°ï¼Œå°è¯•ä»æ¶ˆæ¯å†…å®¹ä¸­æœç´¢å›¾ç‰‡ URLï¼ˆå¯èƒ½æ˜¯æ–‡æœ¬æ ¼å¼ï¼‰\r\n      if (!extractedData) {\r\n        for (const msg of data.messages) {\r\n          if (msg.content && typeof msg.content === 'string') {\r\n            // å°è¯•æŸ¥æ‰¾å›¾ç‰‡ URLï¼ˆhttp:// æˆ– https:// å¼€å¤´çš„ URLï¼‰\r\n            const urlMatch = msg.content.match(/https?:\\/\\/[^\\s\"']+\\.(jpg|jpeg|png|gif|webp)/i)\r\n            if (urlMatch) {\r\n              const imageUrl = urlMatch[0]\r\n              // å°è¯•æå–å…¶ä»–ä¿¡æ¯\r\n              let diagnosis = null\r\n              let advice = msg.content\r\n              let keywords = []\r\n\r\n              // å°è¯•ä»å†…å®¹ä¸­æå– JSONï¼ˆå¯èƒ½å›¾ç‰‡ URL å’Œå…¶ä»–ä¿¡æ¯åœ¨åŒä¸€ä¸ªæ¶ˆæ¯ä¸­ï¼‰\r\n              try {\r\n                const parsed = JSON.parse(msg.content)\r\n                if (parsed && typeof parsed === 'object') {\r\n                  extractedData = {\r\n                    image_url: parsed.image_url || imageUrl,\r\n                    diagnosis: parsed.diagnosis || null,\r\n                    advice: parsed.advice || advice,\r\n                    keywords: parsed.keywords || [],\r\n                  }\r\n                } else {\r\n                  extractedData = {\r\n                    image_url: imageUrl,\r\n                    diagnosis: diagnosis,\r\n                    advice: advice,\r\n                    keywords: keywords,\r\n                  }\r\n                }\r\n              } catch (e) {\r\n                // ä¸æ˜¯ JSONï¼Œä½¿ç”¨æå–çš„å›¾ç‰‡ URL\r\n                extractedData = {\r\n                  image_url: imageUrl,\r\n                  diagnosis: diagnosis,\r\n                  advice: advice,\r\n                  keywords: keywords,\r\n                }\r\n              }\r\n\r\n              if (import.meta.env.DEV) {\r\n                console.log('âœ… ä»æ¶ˆæ¯æ–‡æœ¬ä¸­æå–åˆ°å›¾ç‰‡ URL:', {\r\n                  messageType: msg.type,\r\n                  imageUrl: imageUrl,\r\n                })\r\n              }\r\n              break\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // ç­–ç•¥6: å¦‚æœä»ç„¶æ²¡æœ‰æ‰¾åˆ°ï¼Œæ„å»ºé»˜è®¤å“åº”\r\n      if (!extractedData) {\r\n        const lastMessage = data.messages[data.messages.length - 1]\r\n        const content = lastMessage?.content || 'ç”Ÿæˆå®Œæˆï¼Œä½†æœªæ‰¾åˆ°å›¾ç‰‡æ•°æ®'\r\n\r\n        extractedData = {\r\n          advice: content,\r\n          image_url: null,\r\n          diagnosis: null,\r\n          keywords: [],\r\n        }\r\n\r\n        if (import.meta.env.DEV) {\r\n          console.warn('âš ï¸ è­¦å‘Š: æ— æ³•ä»å“åº”ä¸­æå–æ ‡å‡†æ ¼å¼æ•°æ®ï¼Œä½¿ç”¨é»˜è®¤æ ¼å¼', {\r\n            messagesCount: data.messages.length,\r\n            messageTypes: data.messages.map(m => m.type),\r\n            lastMessageContent: content.substring(0, 200),\r\n            suggestion: 'è¯·æ£€æŸ¥ Bot çš„ Workflow é…ç½®ï¼Œç¡®ä¿è¾“å‡º JSON æ ¼å¼çš„æ•°æ®',\r\n          })\r\n        }\r\n      }\r\n    } else {\r\n      // å¦‚æœæ²¡æœ‰ messages æ•°ç»„ï¼Œå°è¯•ç›´æ¥ä½¿ç”¨ data\r\n      extractedData = data\r\n    }\r\n\r\n    // å¼€å‘ç¯å¢ƒä¸‹æ‰“å°æå–çš„æ•°æ®\r\n    if (import.meta.env.DEV) {\r\n      console.log('æå–çš„æ•°æ®:', extractedData)\r\n    }\r\n\r\n    // 8. æ•°æ®éªŒè¯\r\n    const validation = validateApiResponse(extractedData)\r\n    if (!validation.valid) {\r\n      // æ•°æ®éªŒè¯é”™è¯¯ï¼ŒæŠ›å‡º ValidationError è€Œä¸æ˜¯åŒ…è£…æˆç½‘ç»œé”™è¯¯\r\n      const validationError = new Error(validation.error)\r\n      validationError.name = 'ValidationError'\r\n      throw validationError\r\n    }\r\n\r\n    // 9. è¿”å›æ•°æ®\r\n    return validation.data\r\n  } catch (error) {\r\n    clearTimeout(timeoutId)\r\n\r\n    // 9. é”™è¯¯å¤„ç†\r\n    if (error.name === 'AbortError') {\r\n      const timeoutError = new Error('è¯·æ±‚è¶…æ—¶ï¼šç”Ÿæˆå›¾ç‰‡éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·ç¨åé‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥')\r\n      timeoutError.name = 'TimeoutError'\r\n      throw timeoutError\r\n    }\r\n    if (error instanceof ApiError) {\r\n      throw error\r\n    }\r\n    // æ•°æ®éªŒè¯é”™è¯¯ä¸åŒ…è£…æˆç½‘ç»œé”™è¯¯\r\n    if (error.name === 'ValidationError') {\r\n      throw error\r\n    }\r\n    // å…¶ä»–é”™è¯¯æ‰åŒ…è£…æˆç½‘ç»œé”™è¯¯\r\n    throw new Error(`ç½‘ç»œé”™è¯¯: ${error.message}`)\r\n  }\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react'\nimport { AnimatePresence, motion } from 'framer-motion'\nimport Layout from './components/Layout'\nimport LandingCard from './components/LandingCard'\nimport Loading from './components/Loading'\nimport GuideBubble from './components/GuideBubble'\nimport DreamBook from './components/DreamBook'\nimport { generateDream } from './api/coze'\nimport { handleError } from './utils/errorHandler'\nimport { printDiagnostics } from './utils/apiDiagnostic'\n\n/**\n * ä¸»åº”ç”¨ç»„ä»¶\n * ç®¡ç†åº”ç”¨çŠ¶æ€å’Œé¡µé¢æµè½¬\n * è°ƒæ•´ï¼šå®ç°å•é¡µé¢å¸ƒå±€ï¼Œä¼˜åŒ–è§†å›¾åˆ‡æ¢é€»è¾‘\n */\nfunction App() {\n  // åº”ç”¨çŠ¶æ€\n  const [currentView, setCurrentView] = useState('landing') // 'landing' | 'loading' | 'guide' | 'result'\n  const [userInput, setUserInput] = useState('')\n  const [selectedStyle, setSelectedStyle] = useState(null)\n  const [generationResponse, setGenerationResponse] = useState(null)\n  const [error, setError] = useState(null)\n\n  // å¼€å‘ç¯å¢ƒä¸‹ï¼Œåˆå§‹åŒ–æ—¶æ‰“å°è¯Šæ–­ä¿¡æ¯\n  useEffect(() => {\n    if (import.meta.env.DEV) {\n      printDiagnostics()\n    }\n  }, [])\n\n  // å¤„ç†æäº¤ï¼ˆåœ¨LandingCardä¸­è°ƒç”¨ï¼‰\n  const handleSubmit = async (input, style) => {\n    setUserInput(input)\n    setSelectedStyle(style)\n    setCurrentView('loading')\n    setError(null)\n\n    try {\n      // è°ƒç”¨APIç”Ÿæˆæ¢¦å¢ƒ\n      const response = await generateDream(input, style)\n      setGenerationResponse(response)\n\n      // åˆ¤æ–­å“åº”ç±»å‹\n      if (response.image_url === null && response.diagnosis === null) {\n        // éæ¢¦å¢ƒ â†’ æ˜¾ç¤ºå¼•å¯¼æ°”æ³¡\n        setCurrentView('guide')\n      } else if (response.image_url !== null && response.diagnosis !== null) {\n        // æ˜¯æ¢¦å¢ƒä¸”å·²ç”Ÿæˆ â†’ æ˜¾ç¤ºç«‹ä½“ç»˜æœ¬\n        setCurrentView('result')\n      } else {\n        // å¼‚å¸¸æƒ…å†µ\n        setError({\n          message: 'APIè¿”å›æ•°æ®æ ¼å¼å¼‚å¸¸',\n          type: 'VALIDATION_ERROR'\n        })\n        setCurrentView('landing')\n      }\n    } catch (err) {\n      // é”™è¯¯å¤„ç†\n      const errorInfo = handleError(err)\n      // ç»Ÿä¸€é”™è¯¯å¯¹è±¡ç»“æ„\n      setError({\n        message: errorInfo.message,\n        type: errorInfo.type,\n      })\n      setCurrentView('landing')\n\n      // å¼€å‘ç¯å¢ƒä¸‹ï¼Œæ‰“å°è¯¦ç»†é”™è¯¯ä¿¡æ¯\n      if (import.meta.env.DEV) {\n        console.error('API è°ƒç”¨é”™è¯¯:', {\n          error: err,\n          errorInfo: errorInfo,\n          userInput: input,\n          style: style,\n        })\n      }\n    }\n  }\n\n  // å¤„ç†æ¸…é™¤\n  const handleClear = () => {\n    setUserInput('')\n    setSelectedStyle(null)\n    setError(null)\n    setGenerationResponse(null)\n  }\n\n  // å¤„ç†å¼•å¯¼æ°”æ³¡å…³é—­\n  const handleGuideClose = () => {\n    setCurrentView('landing')\n    setUserInput('')\n    setSelectedStyle(null)\n    setGenerationResponse(null)\n  }\n\n  // å¤„ç†è¿”å›æ“ä½œï¼ˆæ¸…ç©ºæ‰€æœ‰çŠ¶æ€ï¼‰\n  const handleBack = () => {\n    // æ¸…ç©ºæ‰€æœ‰çŠ¶æ€\n    setUserInput('')\n    setSelectedStyle(null)\n    setError(null)\n    setGenerationResponse(null)\n    // åˆ‡æ¢å›è¾“å…¥ç•Œé¢\n    setCurrentView('landing')\n  }\n\n  // æ¸²æŸ“å½“å‰è§†å›¾\n  const renderCurrentView = () => {\n    switch (currentView) {\n      case 'landing':\n        return (\n          <LandingCard\n            userInput={userInput}\n            selectedStyle={selectedStyle}\n            onInputChange={setUserInput}\n            onStyleChange={setSelectedStyle}\n            onSubmit={handleSubmit}\n            onClear={handleClear}\n          />\n        )\n\n      case 'loading':\n        return <Loading />\n\n      case 'guide':\n        return (\n          generationResponse && (\n            <GuideBubble\n              advice={generationResponse.advice}\n              onClose={handleGuideClose}\n            />\n          )\n        )\n\n      case 'result':\n        return (\n          generationResponse &&\n          generationResponse.image_url &&\n          generationResponse.diagnosis && (\n            <DreamBook\n              imageUrl={generationResponse.image_url}\n              diagnosis={generationResponse.diagnosis}\n              advice={generationResponse.advice}\n              keywords={generationResponse.keywords}\n              onBack={handleBack}\n            />\n          )\n        )\n\n      default:\n        return (\n          <LandingCard\n            userInput={userInput}\n            selectedStyle={selectedStyle}\n            onInputChange={setUserInput}\n            onStyleChange={setSelectedStyle}\n            onSubmit={handleSubmit}\n            onClear={handleClear}\n          />\n        )\n    }\n  }\n\n  return (\n    <Layout>\n      <AnimatePresence mode=\"wait\">\n        {renderCurrentView()}\n      </AnimatePresence>\n\n      {/* é”™è¯¯æç¤º */}\n      {error && (\n        <motion.div\n          className=\"fixed bottom-4 left-1/2 transform -translate-x-1/2 cloudmorphism p-4 max-w-md z-50\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          exit={{ opacity: 0, y: 20 }}\n        >\n          <p className=\"text-white text-center\">\n            {error?.message || (typeof error === 'string' ? error : 'å‘ç”ŸæœªçŸ¥é”™è¯¯')}\n          </p>\n          {import.meta.env.DEV && error?.type && (\n            <p className=\"text-white/60 text-xs text-center mt-1\">\n              é”™è¯¯ç±»å‹: {error.type}\n            </p>\n          )}\n          <button\n            onClick={() => {\n              setError(null)\n              setCurrentView('landing')\n            }}\n            className=\"mt-2 w-full py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition\"\n          >\n            è¿”å›\n          </button>\n        </motion.div>\n      )}\n    </Layout>\n  )\n}\n\nexport default App\n\n\n","import React from 'react'\r\n\r\n/**\r\n * é”™è¯¯è¾¹ç•Œç»„ä»¶\r\n * æ•è·å­ç»„ä»¶æ ‘ä¸­çš„ JavaScript é”™è¯¯ï¼Œå¹¶æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ç•Œé¢\r\n */\r\nclass ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = { hasError: false, error: null, errorInfo: null }\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    // æ›´æ–° state ä½¿ä¸‹ä¸€æ¬¡æ¸²æŸ“èƒ½å¤Ÿæ˜¾ç¤ºé™çº§åçš„ UI\r\n    return { hasError: true, error }\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    // è®°å½•é”™è¯¯ä¿¡æ¯\r\n    console.error('é”™è¯¯è¾¹ç•Œæ•è·:', error, errorInfo)\r\n    this.setState({\r\n      error,\r\n      errorInfo\r\n    })\r\n\r\n    // å¯ä»¥åœ¨è¿™é‡Œå‘é€é”™è¯¯åˆ°æ—¥å¿—æœåŠ¡\r\n    // ä¾‹å¦‚ï¼šlogErrorToService(error, errorInfo)\r\n  }\r\n\r\n  handleReload = () => {\r\n    // é‡æ–°åŠ è½½é¡µé¢\r\n    window.location.reload()\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return (\r\n        <div\r\n          className=\"aurora-bg min-h-screen w-full flex flex-col items-center justify-center p-4\"\r\n          style={{\r\n            background: 'linear-gradient(to bottom right, #fbcfe8, #c4b5fd, #818cf8)'\r\n          }}\r\n        >\r\n          <div className=\"bg-white/40 backdrop-blur-md border border-white/50 rounded-2xl shadow-xl p-8 max-w-md w-full text-center\">\r\n            <div className=\"text-6xl mb-4\">ğŸ˜”</div>\r\n            <h1 className=\"text-2xl md:text-3xl font-bold text-indigo-900 mb-4\">\r\n              é¡µé¢åŠ è½½å‡ºé”™\r\n            </h1>\r\n            <p className=\"text-indigo-800 mb-6\">\r\n              æŠ±æ­‰ï¼Œé¡µé¢é‡åˆ°äº†é—®é¢˜ã€‚è¯·å°è¯•åˆ·æ–°é¡µé¢ï¼Œæˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚\r\n            </p>\r\n\r\n            <button\r\n              onClick={this.handleReload}\r\n              className=\"px-6 py-3 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors duration-200 mb-4 w-full\"\r\n            >\r\n              åˆ·æ–°é¡µé¢\r\n            </button>\r\n\r\n            {import.meta.env.DEV && this.state.error && (\r\n              <details className=\"mt-4 text-left\">\r\n                <summary className=\"cursor-pointer text-indigo-700 font-medium mb-2\">\r\n                  é”™è¯¯è¯¦æƒ…ï¼ˆå¼€å‘ç¯å¢ƒï¼‰\r\n                </summary>\r\n                <div className=\"bg-black/20 backdrop-blur-sm rounded-lg p-4 overflow-auto max-h-60\">\r\n                  <pre className=\"text-xs text-indigo-900 whitespace-pre-wrap break-words\">\r\n                    {this.state.error.toString()}\r\n                    {this.state.errorInfo && (\r\n                      <>\r\n                        {'\\n\\n'}\r\n                        {this.state.errorInfo.componentStack}\r\n                      </>\r\n                    )}\r\n                  </pre>\r\n                </div>\r\n              </details>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    return this.props.children\r\n  }\r\n}\r\n\r\nexport default ErrorBoundary\r\n\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom/client'\r\nimport App from './App.jsx'\r\nimport ErrorBoundary from './components/ErrorBoundary'\r\nimport './styles/index.css'\r\n\r\nReactDOM.createRoot(document.getElementById('root')).render(\r\n  <React.StrictMode>\r\n    <ErrorBoundary>\r\n      <App />\r\n    </ErrorBoundary>\r\n  </React.StrictMode>,\r\n)\r\n\r\n"],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","HeroHeader","badges","jsxs","motion","jsx","badge","index","Layout","children","DreamInput","userInput","error","onInputChange","defaultAttributes","toKebabCase","string","createLucideIcon","iconName","iconNode","Component","forwardRef","color","size","strokeWidth","absoluteStrokeWidth","className","rest","ref","createElement","tag","attrs","ArrowLeft","ChevronDown","Sparkles","STYLES","StyleDropdown","value","onChange","styles","DEFAULT_STYLES","isOpen","setIsOpen","useState","focusedIndex","setFocusedIndex","dropdownRef","useRef","menuRef","useEffect","handleClickOutside","event","handleKeyDown","handleSelect","prev","selectedStyle","style","styleId","handleToggle","AnimatePresence","ClearButton","onClick","MainCTAButton","loading","disabled","isDisabled","Fragment","ControlBar","onStyleChange","onClear","onSubmit","isSubmitting","validateUserInput","input","trimmed","validateStyle","validStyles","validateApiResponse","data","LandingCard","memo","setError","setIsSubmitting","handleInputChange","useCallback","handleStyleChange","handleClear","handleSubmit","inputValidation","styleValidation","err","Loading","message","loadingMessages","displayMessage","GuideBubble","advice","onClose","throttle","fn","delay","lastCallTime","timeoutId","args","now","timeSinceLastCall","useDeviceOrientation","orientation","setOrientation","response","setupOrientationListener","handleOrientation","handleVisibilityChange","useParallax","parallax","setParallax","beta","gamma","isGyroSupported","isMobile","handleMouseMove","clientX","clientY","innerWidth","innerHeight","rotateY","rotateX","DreamBook","imageUrl","diagnosis","keywords","onBack","keyword","ApiError","statusCode","handleError","errorMessage","errorType","generateDream","apiUrl","botId","token","authPrefix","queryText","requestBody","requestOptions","controller","requestStartTime","requestDuration","errorData","text","extractedData","answerMessage","msg","content","parsedContent","parsed","urlMatch","lastMessage","validation","validationError","timeoutError","App","currentView","setCurrentView","setUserInput","setSelectedStyle","generationResponse","setGenerationResponse","errorInfo","handleGuideClose","handleBack","renderCurrentView","ErrorBoundary","React","props","__publicField","ReactDOM"],"mappings":"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","x_google_ignoreList":[0,1,2,6,7,8,9,10]}